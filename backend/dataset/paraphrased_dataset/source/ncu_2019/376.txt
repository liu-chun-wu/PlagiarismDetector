SCNFS 一共分為六個階層，包含輸入層（Input layer）、球型複數模糊集層（SCFS layer）、前鑑部層（Premise layer）、正規化層（Normalization layer）、後鑑部層（Takagi- Sugeno layer）與輸出層（Output layer）。圖 4 為SCNFS 之架構圖。以下為各階層的功 能介紹： 卷積模糊神經系統於財金市場數據之研究 圖 4：SCNFS 之架構圖 SCNFS 架構第一層：輸入層 此階層接收CNN 的輸出值作為SCNFS 輸入值，並將輸入值傳入下一階層。輸入值 可表示如下： ℎ⃑⃑= [ℎ1, ℎ2, … , ℎ𝑀]𝑇, (24) 其中，𝑀為輸入值的總個數。 SCNFS 架構第二層：球型複數模糊集層 此階層的每一節點都代表著一個球型複數模糊集，經由歸屬函數的計算，可呈現每 個輸入值對應的球型複數模糊集之歸屬程度。歸屬函數如下： 𝜇⃑𝑖,𝑗= 𝐴𝑖,𝑗(ℎ𝑖; 𝑐𝑖,𝑗, 𝜎𝑖,𝑗), (25) 卷積模糊神經系統於財金市場數據之研究 其中，𝑖= 1,2, … , 𝑀；𝑗= 1,2, … , |𝑇𝑖|，|𝑇𝑖|為第𝑖個輸入值之語譯變數個數；ℎ𝑖為第𝑖個輸入 值；𝑐𝑖,𝑗為第𝑖個輸入值的第𝑗個中心值；𝜎𝑖,𝑗為第𝑖個輸入值的第𝑗個寬度；𝐴𝑖,𝑗為第𝑖個模型 輸入的第𝑗個球型複數模糊集的歸屬函數。為減少主觀式設定，在此階層的建立方法上， 使用減法分群法（Subtractive clustering）[35]，將輸入進行分群並計算出各群的中心值及 其寬度，建立出每一個輸入的球型複數模糊集之歸屬函數。 SCNFS 架構第三層：前鑑部層 此階層的每一個節點代表一條規則之前鑑部。規則的建構方法如下，將所有輸入值 之語譯變數，經由笛卡兒乘積（Cartesian product）計算，會得到𝐾個組合，每一個組合 代表一條規則，這些規則皆獨立且不重複。規則的前鑑部是計算輸入值對不同規則的關 聯性，可稱之為啟動強度（Firing strength, 𝛽）。計算方法如下式： 𝛽⃑(𝑘) = ∏𝜇⃑𝑖 (𝑘) 𝑀 𝑖=1 , (26) 其中，𝑘= 1,2, … , 𝐾，𝐾為規則個數；𝜇⃑𝑖 (𝑘)為第𝑘條規則的第𝑖個輸入值對應之球型複數模 糊集歸屬程度。 SCNFS 架構第四層：正規化層 此階層是將前一層計算出的所有啟動強度進行加總。隨後，將加總值除上所有啟動 強度後，可得到每一條規則的正規化啟動強度值（𝜆）。其目的是以權重的方式，調整每 一條規則的輸出值，達成非線性的輸出效果。計算方法如下式： 𝜆⃑(𝑘) = 𝛽⃑(𝑘) ∑ 𝛽⃑(𝑘) 𝐾 𝑘=1 . (27) 卷積模糊神經系統於財金市場數據之研究 SCNFS 架構第五層：後鑑部層 此階層是以T-S 模糊規則為基礎，乘上對應的正規化啟動強度值後，會得到此條規 則的輸出值。計算方法如下式： 𝑦̂⃑(𝑘) = 𝜆⃑(𝑘) × (𝑎0 (𝑘) + 𝑎1 (𝑘)ℎ1 + ⋯+ 𝑎𝑀 (𝑘)ℎ𝑀), (28) 其中，𝑦̂⃑(𝑘)為第𝑘條規則的輸出值；𝑎𝑚 (𝑘)為第𝑘條規則第𝑚個輸入值的調整參數。 SCNFS 架構第六層：輸出層 此階層的輸入值為每條規則的輸出值，將所有規則的輸出值加總後，就能得到模型 的輸出值𝑦̂⃑，為複數型態的向量。計算方法如下式： 𝑦̂⃑= ∑𝑦̂⃑(𝑘) 𝐾 𝑘=1 . (29)
