Weight Neural Network Model 為將Pure NN 與Rule Based Improved NN 的預測結果 結合量測資料訓練一個新的自動權重模型，以驗證是否能結合Pure NN 與Rule Based Improved NN 的結果，降低平均誤差，表4-13 為Weight Neural Network 在各個階層的 設定與Loss, Metrics,  optimizer 等設定，實驗四將以三種訓練資料處理(去極端值、low variance、極端值low variance)比較在五種補值方法下的各種狀況如何影響Weight NN 的預測值與量測值的誤差。 表4-13 Weight Neural Network 設定 rn Neural Count Activation 1,000 relu 1,000 elu relu elu elu elu elu elu Loss = ‘mse’ metrics=['mse', 'mae', 'mape'] optimizer='Adam' 圖4-15 為Weight NN 在訓練資料去除極端值未去除low variance 的狀況下預測結果 與目標每點差異的長條圖，與圖4-6、圖4-9 和圖4-12 相比，圖4-15 的誤差範圍較其他 圖皆較小，而以圖4-15 的各種補值方法比較，以Max 補值的誤差範圍較小，以Median 補值的誤差範圍較大。 圖4-15 Weight NN 預測結果(去極端值) (圖片來源：本研究整理) 表4-14 為Weight NN 在訓練資料去除極端值未去除low variance 的狀況下預測結果 與目標的平均誤差，相較表4-3、表4-7 和表4-10，表4-14 的平均誤差範圍較小，而以 表4-14 比較各補值方法的平均誤差，可觀察到以Min 補值的平均誤差較小，以Mean 補值的平均誤差較大。 表4-14 Weight NN 補值方法比較表(去極端值) Median Zero Test Train Test Train 0.04553 0.03242 0.04372 0.03312 Max Min Test Train Test Train 0.04534 0.03323 0.04319 0.03311 Mean Test Train 0.04635 0.03879 圖4-16 為Weight NN 在訓練資料去除low Variance 但未去除極端值的狀況下預測結 果與目標每點差異的長條圖，因未去除極端值，在1 以下的數值無法清楚比較，但可觀 察以Median 補值的誤差範圍較大，以Max 補值的誤差範圍較小。 圖4-16 Weight NN 預測結果(去low variance) (圖片來源：本研究整理) 表4-15 為Weight NN 在訓練資料去除low variance 未去除極端值的狀況下預測結果 與目標的平均誤差，相較表4-4、表4-8 和表4-11，表4-15 的平均誤差較小，而以表4-15 比較各補值方法的平均誤差，可觀察到以Min 補值的平均誤差較小，以Max 補值的平 均誤差較大。 表4-15 Weight NN 補值方法比較表(去low variance) Median Zero Test Train Test Train 0.05777 0.04853 0.05773 0.04843 Max Min Test Train Test Train 0.05972 0.04697 0.05386 0.05303 Mean Test Train 0.05231 0.04840 圖4-17 為Weight NN 在訓練資料同時去除low Variance/除極端值的狀況下預測結 果與目標每點差異的長條圖，與圖4-8、圖4-11 和圖4-12 相比，圖4-17 的誤差範圍較 小，而以圖4-17 的各種補值方法比較，以Median 補值的誤差範圍較小，以Mean 補值 的誤差範圍較大。 圖4-17 Weight NN 預測結果(去low variance/極端值) (圖片來源：本研究整理) 表4-16 為Weight NN 在訓練資料同時去除low variance/極端值的狀況下預測結果與 目標的平均誤差，相較表4-4、表4-8 和表4-10，表4-16 的平均誤差較小，而以表4-16 比較各補值方法的平均誤差，可觀察到以Median 補值的平均誤差較小，以Mean 補值 的平均誤差較大。 表4-16 Weight NN 補值方法比較表(去low variance/極端值) Median Zero Test Train Test Train 0.04452 0.01912 0.04675 0.04038 Max Min Test Train Test Train 0.04655 0.03564 0.04683 0.04042 Mean Test Train 0.04867 0.03610 實驗四在三種資料處理的狀況下比較五種遺失值處理方法和實驗一、實驗二、實驗 三的結果相互比較後可得到以下結論： 1. Weight NN 可顯著使平均誤差降低。 2. 同時去low variance/極端值與只去除去中一項相比更能使Weight NN 預測結果 接近目標值。 3. 去除極端值較去除low variance 對Weight NN 的預測結果影響更大。 4. 在各項的比較當中，以Median 補值且去除low variance/極端值相對使Weight NN 預測結果最接近目標值。 以實驗四的結果可觀察到Weight NN 較Pure NN、Rule Based NN 和手動權重模 型，在每一個實驗結果上平均誤差皆較低，可證明Weight NN 可以使平均誤差降低， 因此可達到實驗三、四的目的—結合Pure NN 與Rule Based NN 的經驗使整體模型的 平均誤差降低，而跟實驗三的結果比較可推論Weight NN 除了將Pure NN 與Rule Bas ed NN 的結果以一定比例結合外，使用了NN 的模型加上資料結果的訓練，使模型架構 能真正結合兩個模型的預測結果找出平均誤差更低的預測結果。
