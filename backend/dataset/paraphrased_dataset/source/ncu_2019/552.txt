恆生指數是香港最早的股票市場指數之一， 並以1964 年7 月 31 日為基 日，100 點為基值。 恆生指數採用市值加權法計算編製而成，由33 隻成份股組 成，涵蓋香港股票市場總市值超過70%。香港的自由經濟系統高度依賴國際的貿 易，同時也是生產總額超越西歐的四個主要經濟體系之一。 本實驗收集了香港恆生股價指數(HSI)從1997 年至2003 年以及2006 年至2012 年 的1 月1 日至12 月31 日的股票收盤價做為樣本，並將此資料集分成訓練資料 集、測試資料集兩個部份，其中從1 月1 日至10 月31 日的資料集將做為訓練資 料，從11 月1 日至12 月31 日做為測試資料。依據技術分析歷史會不斷重演之 原則，因此市場價格不論如何變化，只要從歷史價格觀察其規律，亦可以預測未 來的趨勢，市場價格已反映所有資訊，市場價格會沿趨勢與形態移動，因市場價 格發展之規律，非隨機且具有一定趨勢及形態。因此本研究以五項指標作為模型 的輸入變數，包刮開盤價、最高價、最低價、簡單移動平均縣、指數平均線。 五個被選為模型的輸入訓練資料，分別是𝑓1, 𝑓2, 𝑓3, 𝑓4, 𝑓5，其中𝑓1為香港恆生指數 模糊類神經系統在時間序列之預測與應用 實驗與研究結果 研究生：侯夆霖 指導教授：李俊賢博士 的開盤價，𝑓2為香港恆生指數的最高價，𝑓3為為香港恆生指數的最低價，𝑓4為香 港恆生指數的移動平均線，𝑓5為香港恆生指數的指數平均線。訓練資料表示為 {(x⃑ (𝑖), y⃑ (𝑖)), 𝑖= 1,2, … 𝐼}，其中x⃑ (𝑖)包含了𝑓1, 𝑓2, 𝑓3, 𝑓4, 𝑓5這五個維度，而y⃑ (𝑖)則是模 型的目標，𝐼表示共有𝐼對的資料。 在本次實驗模型中，共有5 個特徵被選到做為模型輸入，模型前鑑部使用的模糊 集合為高斯模糊集合，模型共有10 個前鑑部。後鑑部為Takagi-Sugeno 型態，共 有10 個後鑑部，而模型的輸出為一個一維向量。模型設定如表8。 表 8 實驗二模糊類神經模型設定 模糊類神經模型設定 模型輸入 {𝑓1, 𝑓2, 𝑓3, 𝑓4, 𝑓5} 模型輸入的模糊集合 2,2,2,2,2 模糊集合類型 高斯模糊集合 前鑑部個數 前鑑部參數總個數 後鑑部規則個數 後鑑部規則參數總個數 在本實驗中使用的機器學習演算法為粒子群群演算法與遞迴最小平方演算法 合成的複合式演算法，在此次實驗總迭代設定次數設定為100 次迭代，每次迭代 更新粒子群中75 個粒子。粒子的初始位置是以訓練的平均值與標準差所得的參 數，機器學習演算法的詳細配置如表9。 表 9 實驗二PSO-RLSE 複合式演算法參數設定 PSO 粒子群之群數量 學習的跌代次數 粒子的權重設定 1.2 常數𝑐1的設定 常數𝑐2的設定 粒子的速度上限設定 粒子的速度下限設定 -25 模糊類神經系統在時間序列之預測與應用 實驗與研究結果 研究生：侯夆霖 指導教授：李俊賢博士 RLSE 後鑑部參數數量 𝛼 𝐼 60*60 單位矩陣 𝑃0 𝛼𝐼 𝜃0 60*1 零矩陣 本次實驗同樣的配置共跑了10 次，以下圖為10 次實驗中最佳的一次結果， 圖 12 為模型的學習曲線，圖 13 為訓練與預測的結果，圖14 是模型輸出與實際 目標之間的誤差，圖 15 是訓練資料的回歸圖，圖 16 則是測試資料的回歸圖。 效能與其他文獻比較如表 10，利潤與其他文獻比較如表11、12、13，改良利潤 與其他模型比較如表14。 圖 12 學習曲線。(實驗二：恆生指數，1998 年)- 進行100 次迭代的學習曲線。 Iteration RMSE 模糊類神經系統在時間序列之預測與應用 實驗與研究結果 研究生：侯夆霖 指導教授：李俊賢博士 圖 13 預測結果曲線。(實驗二：恆生指數，1998 年)- 藍色實線為實際目標值，紅色虛線為模型預測值。 圖 14 預測誤差曲線。(實驗二：恆生指數，1998 年)- 虛線以左為訓練階段誤差值，虛線以右為測試階段誤差值。 Trading date index Stock index (HSI) Training phase Testing phase Forcast Target Trading date index -1000 -500 Stock index (HSI) Training phase Testing phase 模糊類神經系統在時間序列之預測與應用 實驗與研究結果 研究生：侯夆霖 指導教授：李俊賢博士 圖 15 訓練資料回歸圖。(實驗二：恆生指數，1998 年)- 由於相關係數介於0.7~0.99 之間，訓練資料有高度的相關性。Output 表示模型輸 出，Target 表示測試資料值，Data 表示原始資料，Y=T 表示實際上原始的線性回 歸線，Fit 表示資料點而形成的回歸線偏差值。 Target Output ~= 0.98*Target + 1.5e+02 Training Data: R=0.98292 Data Fit Y = T 模糊類神經系統在時間序列之預測與應用 實驗與研究結果 研究生：侯夆霖 指導教授：李俊賢博士 圖 16 測試資料回歸圖。(實驗二：恆生指數，1998 年)- 由於相關係數介於0.4~0.69 之間，測試資料有中度的相關性。Output 表示模型輸 出，Target 表示測試資料值，Data 表示原始資料，Y=T 表示實際上原始的線性回 歸線，Fit 表示資料點而形成的回歸線偏差值。
