本系統改善謝昀峻（2018）提出之框架，完整系統架構如圖 3，可分成四個階 段，從針對美國股票使用等分法切割與排名，接著建立投資組合模型回測過往績效， 再針對績效結果作分析，最後將結果以視覺化呈現，本系統特色為每個步驟皆可擴充 所需之選股樣本、變數或分析功能。 圖 3、系統架構圖 使用等分法切割與排名 第一步驟如圖 4 所示，此步驟是先從股票資料庫中取得選股樣本中所有公司的財 務資料，再依據不同時間點（季或年）處理所有資料，計算基本面因子，並將各項基 本面數值優劣作排序及等分切割，供後續選股及分析使用。 圖 4、等分法切割與排名架構 計算投資組合績效 為達成投資組合可擴充性及簡化不同策略之間比較程序，本研究設計一套自動化 計算投組績效流程，先將由不同變數組成的投資組合以Python 程式設計物件導向化， 形成投資組合模型，如圖 5，此模型可根據使用者欲分析、比較的投組變數進行擴 充，且只需修改最上層類別，下層類別便會自動更新，接著呼叫 Amibroker 讀取可執 行分析專案檔（Analysis Project File，apx），使Amibroker 自動執行「單一策略參數最 佳化」以及「個股技術面交易策略回測」。 圖 5、物件化投資組合模型類別圖 而由Amibroker 取得所有股票於技術面分析下的進、出場點後，再交由Python 依 據基本面因子排名、資金配置法、資金再投入法、最大持有股數進行選股投資，最後 計算出每個投資組合的績效指標數值。 圖 6、自動化計算投組績效架構 投資組合績效分析 利用前述物件導向之投資組合模型，針對 Amibroker 績效回測結果作分析，本系 統整合文獻探討中提及之評估指標，分析敘述型統計、相關性、關鍵績效指標與獲利 來源等項目，探討各項變數設定對於獲利與風險的影響，並將分析結果存入資料庫以 供後續視覺化使用，架構圖如下圖 7。 圖 7、投資組合績效分析架構 視覺化結果呈現 此部分架構如下圖 8，為將分析過後的結果以淺顯易懂的方式呈現給使用者，本 研究使用Jupyter Notebook 作為平台，以Python 設計視覺化模組，由資料庫讀取分析 結果，除了一般敘述性統計結果，另以視覺圖表呈現績效與風險分析結果，圖表部分 有回歸分析圖、關鍵績效指標分析圖與獲利來源分析圖。 圖 8、視覺化結果呈現架構
