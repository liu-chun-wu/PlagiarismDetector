Rule Based Improved Neural Network Model 為訓練資料中將預先由專業知識挑選出 的重要維度保留(約50 個維度)，並將其餘維度以0 取代，使模型以重要維度模擬量測 值，表4-6 為Rule Based Improved Neural Network 在各個階層的設定與Loss, Metrics, optimizer 等設定，實驗二將以三種訓練資料處理(去極端值、low variance、極端值low variance)比較在五種補值方法下的各種狀況如何影響Rule Based Improved NN 的預測值 與量測值的誤差。 表4-6 Rule Based Improved Neural Network 設定 rn Neural Count Activation 1,000 relu 1,000 elu relu 1,000 elu elu elu elu elu elu Loss = ‘mae’ metrics=['mse', 'mae', 'mape'] optimizer='Adam' epochs=200 batch_size=20000 圖4-9 為Rule Based Improved NN 在訓練資料去除極端值未去除low variance 的狀 況下預測結果與目標每點差異的長條圖與圖4-6 在同樣條件下的Pure NN 預測結果相 比，在每一個補值方法Rule Based Improved NN 的預測結果皆較為穩定，可證明由專業 知識挑選出的參數的確使模型的預測結果更接近目標，而以圖4-9 觀察各補值方法預測 值的誤差可由圖推論，在Rule Based Improved NN 的訓練資料去除極端值未去除low variance 的條件下，以Max 補值的預測結果雖然會使其中幾個點誤差較大，但大部份的 預測結果皆小於0.15，相對誤差範圍的較穩定，而以Median 補值在0.05 以下的預測平 均誤差較大，相對誤差較大。 圖4-9 Ruled Based Improved NN 預測結果(去極端值) (圖片來源：本研究整理) 表4-7 為Rule Based Improved NN 在訓練資料去除極端值未去除low variance 的狀況下預測結果與目標的平均誤差，以Zero 補值的誤差最小，而以Median 補值的誤 差最大，但相較表4-3 在同樣處理條件下的Pure NN 的預測誤差，Rule Based Improved NN 在各種補值方法下的平均誤差皆比Pure NN 更小。 表4-7 Rule Based Improved NN 補值方法比較表(去極端值) Median Zero Test Train Test Train 0.05069 0.04105 0.04438 0.03567 Max Min Test Train Test Train 0.04586 0.03694 0.04644 0.03888 Mean Test Train 0.04640 0.03334 圖4-10 為圖4-9 為Rule Based Improved NN 訓練資料去除low Variance 但未去除極 端值的狀況下預測結果與目標每點差異的長條圖與圖4-7 在同樣條件下的Pure NN 預測 結果相比，Ruled Based Improved NN 的預測誤差較小，而圖4-10 中以Median 補值的誤 差範圍較大，而以Mean 補值的誤差範圍較小。 圖4-10 Ruled Based Improved NN 預測結果(去low variance) (圖片來源：本研究整理) 表4-8 為Rule Based Improved NN 在訓練資料去除low variance 未去除極端值 的狀況下預測結果與目標的平均誤差，相較表4-4 在同樣條件下Pure NN 的各種補值方 法的平均誤差，Rule Based Improved NN 的誤差更小，但相較表4-7 與去除極端值相比， 僅去除low variance 的平均誤差較大，而以表4-8 的內的各種補值方法比較，以Min 補 值的平均誤差最小，以Zero 補值的平均誤差最大 表4-8 Rule Based Improved NN 補值方法比較表(去low variance) Median Zero Test Train Test Train 0.05950 0.05099 0.06177 0.05493 Max Min Test Train Test Train 0.06065 0.04849 0.05312 0.05008 Mean Test Train 0.05542 0.05251 圖4-11 為Rule Based Improved NN 訓練資料同時去除low Variance/極端值的狀 況下預測結果與目標每點差異的長條圖，與圖4-8 在同樣條件下的Pure NN 預測結果相 比，Ruled Based Improved NN 的預測誤差較小，而以圖4-11 觀察，以Median 補值的誤 差範圍較小，以Mean 補值的誤差範圍較大。 圖4-11 Ruled Based Improved NN 預測結果(去low variance/極端值) (圖片來源：本研究整理) 表4-9 為Rule Based Improved NN 在訓練資料同時去除low variance/極端值的狀況 下預測結果與目標的平均誤差，相較表4-8 與表4-7，表4-9 在Test 和Train 的平均誤 差較小，而相較表4-5 相同條件下的Pure NN 預測平均誤差，Rule Based Improved NN 的平均誤差較小，而以表4-9 的各種補值方法比較，以Median 補值平均誤差較小，以 Mean 補值平均誤差較大。 表4-9 Rule Based Improved NN 補值方法比較表(去low variance/極端值) Median Zero Test Train Test Train 0.04677 0.03073 0.04777 0.03646 Max Min Test Train Test Train 0.04773 0.03699 0.04779 0.03995 Mean Test Train 0.04995 0.03263 實驗二在三種資料處理的狀況下比較五種遺失值處理方法和實驗一的結果相互比 較後可得到以下結論： 1. 同時去low variance/極端值與只去除去中一項相比更能使Rule Based Improved NN 預測結果接近目標值。 2. 去除極端值較去除low variance 對Rule Based Improved NN 的預測結果影響更 大。 3. 在各項的比較當中，以Zero補值的Test(僅去除極端值)和以Median補值的Train 平均誤差最小。 4. Rule Based Improved NN 在每一個比較表中的平均誤差較Pure NN 的平均誤差 小。
