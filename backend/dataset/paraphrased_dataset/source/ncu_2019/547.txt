為了進行模擬交易並顯示利潤，我們引用文獻當中所提及台灣期貨交易所的 兩個交易規則[53]，使用兩個交易規則來計算利潤，並假設利潤單位等於一，並 與文獻當中其他模型計算出來的模型進行比較。 因此，利潤公式定義為(31)。 Rule 1: buy rule IF |forecast(𝑡)−actual(𝑡)| actual(𝑡) ≤ 𝛼 and Forecast(𝑡+ 1) −actual(𝑡) > 0 then buy. forecast(t)指的是模型預測出今日的收盤價格，actual(t)指的是今日的實際收盤價 格，𝛼值為股票指數波動性，必須小於一定的範圍內，然而在這邊使用的是文獻 當中所指定的𝛼值。在交易規則上，當明日所測預的收盤價格大於今日的實際收 盤價格時，則應該以今日的實際收盤價格將股票指數購買下來。 Rule 2: sell rule IF |forecast(𝑡)−actual(𝑡)| actual(𝑡) ≤ 𝛼 and Forecast(𝑡+ 1) −actual(𝑡) < 0 then sell. forecast(t)指的是模型預測出今日的收盤價格，actual(t)指的是今日的實際收盤價 格，𝛼值為股票指數波動性，必須小於一定的範圍內，然而在這邊使用的是文獻 當中所指定的𝛼值。在交易規則上，當明日所測預的收盤價格小於今日的實際收 盤價格時，則應該以今日的實際收盤價格將股票指數售出。 Profit=∑ (actual(𝑡+ 1) −actual(𝑡)) 𝑝 𝑡_𝑏=1 + ∑ (actual(𝑡) − 𝑞 𝑡_𝑠=1 actual(𝑡+ 1)) (31) 其中p 代表購買的總天數，q 代表銷售的總天數，t_b 代表購買的第t 天，t_s 代 表銷售的第t 天。規則的意義在於所有購買的股票指數當中，透過明日實際的收 盤價格減去今日實際的收盤價格，所有銷售的股票指數當中，透過今日實際的收 盤價格減去明日實際的收盤價格，接著將兩者的計算結果相加成為最後的利潤。 在過去文獻當中，當模型的預測效能達到訓練數據集中的最佳利潤時，則獲得一 模糊類神經系統在時間序列之預測與應用 研究方法 研究生：侯夆霖 指導教授：李俊賢博士 個權重參數值𝛼，在本研究當中依據文獻當中的權重參數值𝛼和(31)，計算不同模 型的利潤和文獻中模型所計算出的利潤進行比較。 因為文獻當中所提出的利潤計算方式，並沒有資金的概念，也沒有股票的概念， 對於一般投資者而言無法掌握到對於股票買賣的實際狀況，故本研究沿用台灣期 貨交易所的兩個交易規則並針對利潤計算的公式進行改良，利潤公式定義為 (32)。 Rule 1: buy rule IF |forecast(𝑡)−actual(𝑡)| actual(𝑡) ≤ 𝛼 and Forecast(𝑡+ 1) −actual(𝑡) > 0 then buy and stock+ Capital * 𝛽/actual(𝑡). forecast(t)指的是模型預測出今日的收盤價格，actual(t)指的是今日的實際收盤價 格，𝛼值為股票指數波動性，必須小於一定的範圍內，然而在這邊使用的是文獻 當中所指定的𝛼值。其中Capital 代表資金的初始值，本研究以一百萬作為資金初 始值為研究，stock 代表股票初始值，本研究以0 張股票作為資金初始值為計 算，𝛽值代表購買股票的權重，其範圍為0≤ 𝛽≤1。在交易規則上，當明日所測 預的收盤價格大於今日的實際收盤價格時，則應該以今日的實際收盤價格將股票 指數購買進來，接著將資金扣除所購買股票的費用。 Rule 2: sell rule IF |forecast(𝑡)−actual(𝑡)| actual(𝑡) ≤ 𝛼 and Forecast(𝑡+ 1) −actual(𝑡) < 0 And stock>0 then sell and stock-stock* 𝛾. forecast(t)指的是模型預測出今日的收盤價格，actual(t)指的是今日的實際收盤價 格，𝛼值為股票指數波動性，必須小於一定的範圍內，然而在這邊使用的是文獻 當中所指定的𝛼值。其中stock 代表股票初始值，本研究以0 張股票作為資金初始 值為計算，𝛾代表賣出股票的權重，其範圍為0≤ 𝛽≤1。在交易規則上，當明日 模糊類神經系統在時間序列之預測與應用 研究方法 研究生：侯夆霖 指導教授：李俊賢博士 所測預的收盤價格小於今日的實際收盤價格時，則應該以今日的實際收盤價格將 股票指數售出。 Rule 3: Profit rule for (total number of days /n) for i=1: n if  buy rule is established Stock_number = Capital ∗𝛽/ actual(t) Capital = Capital −Capital ∗𝛽 Stock = Stock+ Stock_number elseif  sell rule is established Stock_number = Stock∗𝛾 Capital = Capital + Stock_number ∗actual(t) Stock = Stock- Stock_number end end if stock>0 then Capital = Capital + stock*actual(t) end Profit = Capital-10000000 (32) 在交易規則當中Capital 代表資金的初始值，本研究以一百萬作為資金初始值為 研究，stock 代表股票初始值，本研究以0 張股票作為資金初始值為計算，n 代表 為結算日期，本研究以5 天、10 天、15 天、20 天、25 天、30 天作為不同結算日 期的計算。舉例來說，若想知道有一期23 天的股票指數以5 天為單位做為結算 日，其運作方式為23 除以5，整數為4，代表會有4 次的結算日，當遇到結算日 時，會將手邊的股票以當日的收盤價格售出以獲取利潤。 模糊類神經系統在時間序列之預測與應用 實驗與研究結果 研究生：侯夆霖 指導教授：李俊賢博士 第四章 實驗與研究結果 本節提供了對模型準確性的評估以及與其他模型的比較，以及利潤評估和比 較，為了驗證所提出的模型，本研究使用了3 個實驗來證實，實驗一使用1997 年至2003 年以及2006 年至2012 年的台股加權指數(TAIEX)進行了實驗，實驗二 使用1998 年至2003 年的香港恆生指數(HSI)進行了實驗，實驗三使用1998 年至 2003 年的日本日經指數(Nikkei)進行了實驗，前10 個月期間的數據集用於培訓， 選擇11 月至12 月的數據集進行測試，本研究利用T-S 模糊模型和機器學習中會 利用的演算法，使用以五項指標作為模型的輸入變數，包刮開盤價、最高價、最 低價、簡單移動平均縣、指數平均線作為模型輸入變數，配合模型所使用的機器 學習演算法的應用型態進行運算，模型對於資料預測應用的實驗，以效能和文獻 的比較以及利潤的比較作為呈現。 在實驗之後，本研究比較了所提出模型與傳統模糊時間序列模型的性能。此外， 為了檢驗所提出的模型是否超過最新的模糊時間序列模型，將文獻中模型的性能 與所提出的模型進行比較，從表 3、10、17 中可以看出，本研究所提出的模型優 於其他模型的性能。
