在本文第二章中所提到的PSO-RLSE複合式學習演算法採用PSO與RLSE分別 進行前鑑部與後鑑部參數的訓練，WOA-RLSE複合式學習演算法則是將PSO以鯨 群演算法取代之。前鑑部的參數子集合包含模糊集合的參數，由WOA負責訓練前 鑑部參數建構出模糊集合之後，接著計算啟動強度並且進行正規化作為RLSE的輸 入使用；後鑑部參數子集合則是近似函數的所需參數，由RLSE訓練之。根據迭代 不斷的學習與調整最終得到能夠使輸出與目標的誤差最小化的參數，使測試資料 得以根據學習而得的參數進行目標預測，參數空間的分割則能夠更有效率地找到 最佳解，即為WOA-RLSE複合式學習演算法的主要目的，其演算法流程圖如圖4所 示。 特徵選取對智慧型時間序列預測之效能研究 研究方法 研究生：陸怡廷 指導教授：李俊賢博士 圖 4：WOA-RLSE 複合式學習演算法流程圖 Initialization of search agents, fitness, 𝑎𝑎⃗, 𝐴𝐴⃗, 𝐶𝐶⃗, l, and p Update the best search agent p < 0.5 ห𝐴𝐴⃗ห≥1 Update positions by eq. (7) Update positions by eq. (9) Update positions by eq. (11) Update 𝑎𝑎⃗, 𝐴𝐴⃗, 𝐶𝐶⃗, l, and p Stop criteria satisfied? Approximate optimum solution Initialization RLSE 𝐏𝐏𝐟𝐟= 𝛼𝛼𝐈𝐈 𝛉𝛉𝐟𝐟= 𝑧𝑧𝑒𝑒𝑟𝑟𝑐𝑐𝑖𝑖 Calculate 𝐏𝐏𝒌𝒌 Calculate 𝜽𝜽𝒌𝒌 K=k+1 Stop criteria satisfied? Construct fuzzy set Calculate membership degrees of fuzzy sets Calculate firing strengths of fuzzy rules Calculate normalize firing strengths Calculate consequent part Calculate fuzzy system output WOA RLSE Fuzzy Inference system Calculate fitness（RMSE） Yes No Yes Yes No Yes No No 特徵選取對智慧型時間序列預測之效能研究 研究方法 研究生：陸怡廷 指導教授：李俊賢博士 由於本文中使用球型複數模糊集合計算而得的歸屬程度為複數形態，模型的 輸出y亦為複數，故在多目標預測當中的目標也必須為複數型才能夠計算誤差，並 透過誤差值評估參數的學習效能，因此複數型的目標值則以下列方式建構而成： ⎩ ⎨ ⎧ 𝐭𝐭𝐚𝐚𝐭𝐭𝐭𝐭𝐞𝐞𝐭𝐭(𝐟𝐟) = 𝐭𝐭(𝐟𝐟) + 𝐭𝐭(𝐟𝐟) ∗𝑗𝑗 𝐭𝐭𝐚𝐚𝐭𝐭𝐭𝐭𝐞𝐞𝐭𝐭(𝐟𝐟) = 𝐭𝐭(𝐟𝐟) + 𝐭𝐭(𝐟𝐟) ∗𝑗𝑗 ⋮ 𝐭𝐭𝐚𝐚𝐭𝐭𝐭𝐭𝐞𝐞𝐭𝐭(|𝐓𝐓𝐓𝐓|/𝐟𝐟) = 𝐭𝐭(|𝐓𝐓𝐓𝐓|−𝐟𝐟) + 𝐭𝐭(|𝐓𝐓𝐓𝐓|) ∗𝑗𝑗 , (37) 其中target表示為模型的目標；t為目標變數；|𝑇𝑇𝑇𝑇|為目標變數的個數；𝑗𝑗= √−1。 此外，本研究使用均方根誤差（Root-mean-square error, RMSE）以評估目標與 實際輸出之間的誤差值，並將其作為WOA-RLSE複合式演算法的效能指標，其計 算方式如下： 其中m表示為資料對的總數量；𝑒𝑒𝑖𝑖表示為第i對誤差。RMSE即為將誤差的平方和累 加除以資料對總數再進行開根號的結果。 RMSE = ඨ∑ 𝑒𝑒𝑖𝑖 𝑠𝑠 𝑖𝑖=1 𝑚𝑚 , (38) 特徵選取對智慧型時間序列預測之效能研究 實驗內容 研究生：陸怡廷 指導教授：李俊賢博士 第四章 實驗內容 由於不同股票市場之間的收盤價可能具有很大的差異，為確保較大的數據不會 對相對小的數據造成影響並且已知正規化後的數據可以維持模型的可靠性與精準 度[15, 21]，故本研究中所有的實驗數據會先透過正規化，轉化為介於[0,1]之間的 值。正規化公式則採用下式： 𝑥𝑥∗= 𝑥𝑥−𝑥𝑥𝑠𝑠𝑖𝑖𝑟𝑟 𝑥𝑥𝑠𝑠𝑚𝑚𝑚𝑚−𝑥𝑥𝑠𝑠𝑖𝑖𝑟𝑟 , (39) 其中𝑥𝑥為原始資料，𝑥𝑥∗為正規化後的資料，𝑥𝑥𝑠𝑠𝑚𝑚𝑚𝑚、𝑥𝑥𝑠𝑠𝑖𝑖𝑟𝑟為原始資料的最大與最小值 [9, 11, 15]。 本研究中導入了特徵挑選與球型複數類神經模糊系統兩大架構，以一個月份的 資料預測後一天股價，執行實驗十次、每次迭代1000 回的方式，設計出以下三個 實驗個別探討本文之模型架構的優劣。除此之外，模型當中規則數的數量與參數量 有直接的關係，為了控制參數與數據之間的比例不會導致過度凝合（Overfitting） 的現象進而影響到模型的精確度，故需要篩選建構矩陣以減少規則數，此作法稱之 為區塊挑選（Block selection）。其作法是將一區塊內所有輸入的啟動強度進行累加， 若累加值超過所給定的門檻值，則判斷該區塊對於模型有足夠的影響力，並選取該 區塊的模糊規則進行訓練。本研究將區塊挑選的門檻值定義為所有區塊啟動強度 和的平均值，並且從中挑選啟動強度和最高的前2-4 條規則作為模型的訓練參數。
