使用凱特通道作為交易策略時，可搭配不同參數設定以及投資方法，計算凱特通 道包含三個變數，分別是移動平均天數（表示凱特通道長）、凱特通道寬度，以及當作 濾網的天數，本研究參考謝昀駿（2018）提出的變數設定，如下表 7 所示，若使用固 定參數，則所有樣本中股票皆以移動平均120 天作為通道長，0.75 作為通道寬計算上 下通道線，並用50 天成為濾網天數，於Amibroker 策略中的使用如下圖 20。 表 7、凱特通道公式使用變數 變數名稱 代表意義 固定參數 參數最佳化範圍 (min, max, step) Band MALen 凱特通道長 (20, 120, 20) Band Width 凱特通道寬度 0.75 (0.75, 2, 0.25) Filter MaLen 濾網的天數 (50, 225, 25) 圖 20、Amibroker 中凱特通道公式（使用固定參數） 而若選擇套用個股最佳化參數，則會先使用Python 呼叫Amibroker 讀取apx，自 動更換1700 次以上回測商品，針對每一檔股票作參數最佳化，移動平均天數設定從20 天至120 天，每次加上20 天；通道寬從0.75 至2，每次增加0.25；濾網天數則由50 天至225 天，每次增加25 天，最佳化完成後會得到該檔股票在不同變數設定組合下的 獲利，再用Python 讀取每檔股票最佳化結果，挑出獲利最高的變數組合彙整成一個 csv 檔案，做法如圖 21，當Amibroker 套用個股最佳化參數做績效回測時，會讀取該 檔案以取得最佳的變數組合，進行交易判斷，Amibroker 做法如圖 22。 圖 21、彙整出凱特通道最佳化參數 圖 22、Amibroker 中凱特通道公式（讀取最佳化後參數）
