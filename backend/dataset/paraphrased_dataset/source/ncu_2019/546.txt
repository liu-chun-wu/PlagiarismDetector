模糊類神經網路模型建構完成之後，將訓練資料輸入模型之後可以得到系統 輸出值，並將訓練資料與測試的目標資料相比獲得誤差值，系統根據誤差值的大小 調整前鑑部與後鑑部參數。本研究使用粒子群演算法(Particle Swarm optimization, PSO)結合遞迴式最小平方演算法(Recursive least squares estimation, RLSE)，提出 PSO-RLSE 的複合演算法。不同於多層類神經模型(Multilayer Perceptron, MLP)的倒 傳遞演算法以及自適性類神經推理系統(Adaptive neuro fuzzy inference system, ANFIS)的BP-RLSE 複合演算法，本研究以PSO-RLSE 複合演算法將模型中前鑑部 的參數以PSO 優化，PSO 的每個位置由𝑔𝑏𝑒𝑠𝑡提供前鑑部最佳解，後鑑部的規則參 數則以RLSE 尋找啟動強度層每條模糊規則的參數解。而根據公式(22)、(23)可得 後鑑部參數，輸入向量θ和向量b𝑡+1之後如下所示: b𝑡+1 = [𝑏𝑏(1)(𝑡+ 1) 𝑏𝑏(2)(𝑡+ 1) … 𝑏𝑏(𝑘)(𝑡+ 1)] (25) 𝑏𝑏(𝑘)(𝑡+ 1) = [𝜆(𝑘) 𝜆(𝑘)𝑥1(𝑡+ 1) … 𝜆(𝑘)𝑥𝑀(𝑡+ 1)] (26) θ𝑡= [𝜏𝑡 (1) 𝜏𝑡 (2) … 𝜏𝑡 (𝑘)] (27) 𝜏𝑡 (𝑘) = [𝑎0 (𝑘)(𝑡) 𝑎1 (𝑘)(𝑡) ⋯ 𝑎𝑀 (𝑘)(𝑡)] (28) 其中k代表第k 規則數指標，𝜆(𝑘)是每條規則正規化之後的啟動強度，利用此方式 增加效率，可以將系統學習時間降低。該複合型演算法流程如圖6，詳細的演算法 流程如下： Step 1. 將已收集而來時間序列資料分成兩個部份，第一個部份為訓練資料， 時間為各個年度的1 月份到十月份，第二個部份為測試資料，時間序 列集合為各個年度的11 月到12 月的時間 Step 2. 初始粒子群演算法以及遞迴最小平方演算法的參數。粒子群演算法是 用於優化前鑑部高斯模糊集的中心值m、標準差σ。 Step 3. 利用訓練資料輸入模型並計算每條規則的正規化啟動強度。 模糊類神經系統在時間序列之預測與應用 研究方法 研究生：侯夆霖 指導教授：李俊賢博士 Step 4. 利用遞迴式最小平方演算法更新模糊類神經模型的後鑑部參數。 Step 5. 計算模型輸出，並與預測目標的差量計算誤差值。方式如下： 𝑒(𝑡) = 𝑔(𝑡) −𝑦̂ (𝑡) (29) 𝑔(𝑡)是在時間𝑡的實際目標值，𝑦̂ (𝑡)則是在時間𝑡的模糊類神經模型預 測值。 Step 6. 利用誤差值{𝑒(𝑡), 𝑡= 1,2, … , 𝑚}計算均方根誤差(Root-mean-square error, RMSE)，RMSE 計算如下。 RMSE = √∑ |𝑔(𝑡) −𝑦̂ (𝑡)|2 𝑚 𝑡=1 𝑚 (30) Step 7. 回到Step3 直到完成該群所有粒子的計算。 Step 8. 更新𝑔𝑏𝑒𝑠𝑡以及𝑝𝑏𝑒𝑠𝑡，並且更新群體最佳解以及個別最佳解。 Step 9. 回到Step3 直到完成所有粒子的計算。 Step 10. 產生新的粒子並且用以取代表現最差之粒子，各粒子效能表現以 RMSE 作為指標，表現最差即為該粒子RMSE 值最高。 Step 11. 檢查是否達到停止條件。如果達到停止條件， 𝑝𝑏𝑒𝑠𝑡即為優化後之前 鑑部參數。否則再次回到Step3 再次計算。 模糊類神經系統在時間序列之預測與應用 研究方法 研究生：侯夆霖 指導教授：李俊賢博士 圖 6 複合式演算法學習流程圖- 訓練資料輸入模糊類神經模型後，透過第二層高斯模糊集合所計算出的參數為此 模型前鑑部參數，再以PSO 演算法優化，透過第三、四層所計算出的模糊規則為 後鑑部參數，再以RLSE 演算法最佳化。 第五層 後鑑部層 第六層 輸出層 初始化粒子 將粒子作為 前鑑部參數 更新粒子的位置和 速度 達到迭代 停止條件? 第一層 輸入層 第二層 模糊集合層 第三層 啟動強度層 第四層 正規化層 訓練資料 準備 Pn 和θn 更新 Pk+1 更新 θn+1 更新 gbest 和 pbest 設置為θN 後鑑部參數 結束 RLSE 計算粒子 RMSE NFS model PSO 是 否 初始 P0 和θn 模糊類神經系統在時間序列之預測與應用 研究方法 研究生：侯夆霖 指導教授：李俊賢博士
