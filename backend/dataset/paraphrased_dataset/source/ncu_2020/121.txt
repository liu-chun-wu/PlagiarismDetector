於前一節提到信用卡詐欺偵測架構VISA, Master Card 等組織不同意授予 他公司使用，故需要自行開發，但信用卡組織會同意提供有發生詐欺行為的歷 史資料Raw data 給Emvco 認可之實驗室使用，此檔案可以作為我們K-Star 進 行建立Training 資料庫使用，以下會介紹如何使用K-Star 進行詐欺偵測。為了 擴充防止詐欺及保護隱私功能之帳戶式票務系統研究-以大眾運輸為例 要提供更準確的預測我們會採用雙階段判定方法，如圖19 來提升整體的準確 性，如發生例外狀況還是需要由人工來處理。 圖19 雙階段判定方法 資料來源: 【本研究整理】 首先根據K. R. Seeja and Masoumeh Zareapoor(2014) [22] [23][24]與Agrawal, R. and Srikant, R. (1994)[23]提出KNN 搭配Apriori 之資料庫訓練演算法對Visa Raw data 與ABT 資料庫 D 進行訓練，以客人的5 個特徵值進行訓練，演算法 如下: Step 1.  將每位顧客的交易資料從資料庫𝐷中分開。 Step 2.  再從每位顧客的交易之中把詐欺及非詐欺的資料分開。 Step 3.  套用Apriori 演算法[23]應用於每位顧客非詐欺的資料集， Apriori 演算法會回傳一組出現頻率最高特徵資料，將頻率 最高的特徵值對應到該顧客，再將資料回傳存入非詐欺資 料庫中。如圖20 標示1、2 Step 4.  套用Apriori 演算法[23]應用於每位顧客詐欺的資料集， Apriori 演算法會回傳一組出現頻率最高特徵資料，將頻率 最高的特徵值對應到該顧客，再將資料回傳存入詐欺資料 庫中。如圖20 標示1、2。 透過上述四個步驟將資料庫D 的資料完成訓練。 擴充防止詐欺及保護隱私功能之帳戶式票務系統研究-以大眾運輸為例 將資料訓練完成後，接下來說明詐欺偵測的演算法在圖24 “K-Star Predivtive Model”。根據K. R. Seeja and Masoumeh Zareapoor(2014) [22] [23][24]提出的演算法: Step 1. 統計新交易內的特徵在非詐欺的資料集內相符的個數， 定義為𝑙𝑐。 Step 2. 統計新交易內的特徵在詐欺的資料集內相符的個數， 定義為f𝑐。 Step 3. 假設 𝑓𝑐 = 0 且𝑙𝑐 大於所有客人lc 的平均值，則此新的交易 為非詐欺交易，輸出0。 Step 4. 假設 𝑙𝑐 = 0 且𝑓𝑐大於所有客人𝑓𝑐的平均值，則此新的交易 為詐欺交易，輸出1。 Step 5. 假設 𝑓𝑐和𝑙𝑐 都大於0 且𝑓𝑐 ≥ 𝑙𝑐，則新交易為詐欺交易輸出 1，否則為非詐欺交易輸出0。 經過上述5 個步驟後再將判定的資料送回ABT Training 資料庫進行下一 段的Random Forest 演算法的計算如圖20。 圖20 詐欺偵測模組資料訓練流程 資料來源: 【本研究】 擴充防止詐欺及保護隱私功能之帳戶式票務系統研究-以大眾運輸為例 圖21  Customer 特徵值說明 圖片來源: 【本研究整理】 接下來我們使用Random Forest 來說明K-Star 使用上述五個特徵及加權係數 透過Random Forest 的多數決定之集合來預測是否詐欺，如圖22 我們使用多 次取樣計算決策樹的結果，使用多數平均的方式，決定最後預測結果。 圖22  Random Forests 決策原則 圖片來源: 【[10]】 步驟如下: Step 1:定義大小為m 的隨機樣本，就是從資料集中隨機選取m 比資 料，取完後放回。 Step 2:從選取的m 筆資料中，訓練出決策樹。 對每一個節點： 擴充防止詐欺及保護隱私功能之帳戶式票務系統研究-以大眾運輸為例 a. 隨機選取N 個特徵 b. 使用特徵分割該節點 Step 3:重複m 次Step 1 與Step 2 Step 4:彙整所有決策樹的預測，以多數平均方式來決定預測結果。 表 9 交易範例資料 Age Zip Code Amount Job Category Telephone Number Fraud 2,taipei 3,Worker yes 2,taipei 2,Sales yes 1,Kaohsiung 1,engineer yes 資料來源: 【本研究】 使用表9 底色標示的ABT 交易資料進行範例根據[10]Random Forests 演算法 進行實驗，步驟如下: Step 1 比對Age 是否大於50 歲。 Step 2 比對Zip Code 是否在定義內Top 2 的高犯罪率區域。 Step 3 比對交易金額使否超過8k。 Step 4 比對是否為Top 5 高犯罪機率職業。 Step 5 比對於24 小時內發送的10 確認簡訊是否有回應。 我們定義要取3 個Tree 的平均預測值，如圖23 每次隨機從5 個特徵值選取進 行，根據Random Forest 的最後平均預測值結果，底色這筆資料被判定為詐欺 交易，並將此筆資料再放回ABT-Training 資料庫，如有需要可以根據系統的 設計再次取樣重新計算讓結果越趨近高準確率，FP-ABT 就是透過上述的模組 進行詐欺的偵測。 擴充防止詐欺及保護隱私功能之帳戶式票務系統研究-以大眾運輸為例 圖23  Random Forest 詐欺分類範例(3 次取樣) 圖片來源: 【本研究】 圖24  K-Star 模組圖 圖片來源: 【本研究整理】 擴充防止詐欺及保護隱私功能之帳戶式票務系統研究-以大眾運輸為例 由於我們想要把ABT Training 資料庫訓練出一個更好的預測模型，我們透過 使用Light Gradient Boosting(LightGBM)演算法優化K-Star 演算法，而Light Gradient Boosting 是由微軟DMTK 團隊於2016[18]年開發出的一種訓練演算法，效率更高、 準確率更高，而且電腦記憶體使用更低的高效演算法，在圖26 中提到LightGBM， 主要是因為在訓練Visa 所提供的資料是非常大量，我們想要在最有效率的時間內 完成訓練的模型，這時就要會需要透過LightGBM 直方圖演算法優化K- Star 演算法，透過將連續特徵值分段為discrete bins 來加快訓練的速度以及減少記 憶體的使用。 透過上述介紹的K-Star 訓練資料庫配合Random Forest 的決策森林就可以在 K-Star 詐欺偵測流程如圖26 中的 “K-Star Predicitive model”進行詐欺交易偵測。當 旅客使用NFC Tag 或具有NFC 功能之攜帶裝置並已向ABT Server 購買所需要的 旅程並完成Token 寫入NCF 裝置，並準備開始進行旅程，此支付在流程在圖25 流 程中“Welcome the transaction”接下來會向ABT Server 查詢正在感應客戶的資料 於流程中”Request Customer’s data”， 當收到回應的顧客資料進入流程“Get customer’s profile”接下來就進入前面所提到的K-Star Predicitive model 準備進行偵 測，系統會把正在感應的使用者的5 個特徵資如圖料送至”K-Star Predicitive” 進行 查詢，如果K-Star 預測模型將交易標示為可能欺詐非本人使用，會即時將此筆交易 記錄在資料庫中標識為欺詐，並立即拒絕它同時透過ABT Back Office 向使用者傳 送異常交易sms 簡訊，或透過ABT APP 推播通知有異常的交易發生，請使用者聯 繫ABT，進而增加使用的使用的安全性。 擴充防止詐欺及保護隱私功能之帳戶式票務系統研究-以大眾運輸為例 圖25 K-Star 詐欺偵測流程圖 圖片來源: 【本研究整理】 FP-ABT 除了以上的詐欺偵測外，另外一個特色功能就是建立在K-Anonymity 理論上的隱私保護兩者結合的整體系統架構如圖27 所示。 圖26  FP(Fraud Privacy)-ABT 架構 圖片來源: 【本研究整理】 擴充防止詐欺及保護隱私功能之帳戶式票務系統研究-以大眾運輸為例
