3.4.1 Tsunami UDP Protocol（Tsunami） Tsunami UDP Protocol 是一個使用TCP 做傳輸控制，UDP 做資料傳輸的一個開源軟 體，可以讓資料在長距離、高延遲的傳輸環境，仍能維持在非常高的速率。Tsunami UDP Protocol 的原始概念由美國印第安那大學研究員 Mark R. Meiss 博士於2004 年發表的一 篇論文〝TSUNAMI: A High-Speed Rate-Controlled Protocol for File transfer〞。開放原始碼後 經由社群的幫助，目前最新版本為1.1。Tsunami 的設計就是在相同的網路條件下，能比 傳統的TCP 協定傳輸更多的資料。Tsunami 提供一種免費、簡便、高效的檔案傳輸方式， 協助企業減少資料流動的時間成本。 Tsunami 是一種Client-Server 架構的檔案傳輸軟體，在檔案傳輸前Client 會與Server 建立TCP 連線作為傳輸控制之用，此TCP 連線僅傳送如資料塊大小、傳輸速率、錯誤 閥值、時間戳記等控制資料傳輸品質的參數。TCP 連線建立之後，Client 會再建立一個 UDP 連線做資料傳輸。在傳輸過程中，Server 只負責將每個資料塊依順序編號，並依序 傳出。Client 接收到資料塊後進行重組並寫到Disk 中，封包在傳輸過程中有遺失或是 Client 收到順序錯誤的資料塊，Client 會請Server 重傳並將資料塊放置在Retransmission Queue 中等待組合。Client 也會定期計算當前的封包遺失率，若封包遺失率高，則通知 Server 降低傳輸速度。若封包遺失率減少，則通知Server 增加傳輸速度，以充分運用網 路頻寬。 圖3-5 Tsunami architecture 資料來源（Meiss, 2004） Tsunami client 提供了一些參數可以控制傳輸演算法的行為，這些參數包含了：  Which network layer to use（IPv4 or IPv6）;  The size of each data block;  The target transfer rate;  The scaling factors for the inter-packet delay;  The proportion of historical data used in calculating the error rate;  The threshold error rate;  The maximum size of the retransmission queue;  The maximum number of entries in the ring buffer;  The size of the UDP send and receive buffers;  The interval between update periods. Tsunami 存在一些先天缺陷，原始程式碼已經10 年未曾更新且無任何技術支援服務、 資料傳輸無加密功能、只有單線程傳輸等等問題，唯一優勢只有傳輸速度快。總體來說 Tsunami 適用的場景為個人、小規模或臨時資料傳輸或研究使用，較不適合做為大規模 商業用途。 3.4.2 Signiant Signiant 公司是世界首間以開發高速資料傳輸協定而成立的公司，設立於2000 年， 該公司主要產品就叫做Signiant，與Tsunami 相同，Signiant 也是利用UDP 做為資料封包 的傳輸，並使用TCP 作為流量與壅塞控制，在網路環境良好的情況下，可使用UDP 同 時作為資料封包傳輸與流量與壅塞控制，將傳輸效率最大化，有效降低了網路延遲與網 路壅塞造成傳輸效率的影響。 Signiant 採用類似TCP 滑動視窗（Sliding Window）來作流量控制，但是與TCP 採用 的 AIMD（Additive Increase Multiplicative Decrease）演算法不同，Signiant 會隨時量測網路 壅塞狀況，並盡可能地放大視窗以容納更多數據傳輸，定時確認數據送達狀態，當數據 丟失的時候視窗不會急遽縮小，擁有比AIMD 演算法更好的吞吐量。Signiant 是架構在 UDP 上的協定卻有著TCP 的可靠性，在流量控制上確保以最佳速率將資料傳輸給接收 端。壅塞控制可檢測到網路何時超載，並據此進行調整。可靠性機制確保數據丟失後可 以立即重傳，並維持資料接收的順序。 Signiant 身為一款商業軟體，具備良好的使用者介面，傳輸工作的設計採用可重複使 用的範本，在一個傳輸任務量龐大的環境中，管理人員可針對不同的傳輸任務屬性，設 計不同的範本來快速套用，可以大幅節省部署的時間。 Signiant 的頻寬管理功能可以限制每個傳輸任務可分配的頻寬上下限制，讓傳輸所 需要耗費的頻寬變得可以預測，在頻寬有限的情況下，也可以為高重要性的傳輸任務設 定高優先頻寬使用等級，讓重要的任務優先執行。 Signiant 在架構上有Manager 與Agent 兩個角色，Manager 作為管理主控台，每個資 料傳輸的端點稱為Agent，為了強化傳輸安全性，在防火牆之間還可以架設一台Relay Agent 做資料轉送，讓資料在傳輸過程中不但受到防火牆的保護與監控，且外部伺服器 不需要與公司內部網路直接連線（Signiant Control and Visibility, 2020）。 圖3-6 Signiant Manager & Agent 架構 資料來源：（Signiant, 2020） Signiant 的授權分為管理中控台（Manager）與代理程式（Agent），個案公司需要為每 個傳輸端點購買授權，而與公有雲整合、頻寬管理與工作流程自動化作業功能則視為軟 體功能選項，也需要額外加購。其中頻寬管理與工作流程自動化作業對個案公司來說為 需求項目，因此整體採購成本較高。Signiant 採用UDP 來傳輸資料，傳輸加速能力表現 出色，也支援資料壓縮、身分驗證以及傳輸加密。自動化、視覺化的管理介面，讓系統 管理人員可以輕鬆操作與監視數百個傳輸任務。 3.4.3 Synology Presto File Server Synology 群暉科技在2016 年發佈了Presto File Server（Presto FS），讓企業能以SITA （Synology Internet Transfer Accelerator）技術來加快檔案傳輸速度．由於SITA 使用的是 基於UDP 的傳輸方式，搭配自己的封包檢查機制，來加快資料傳到目的地的速度．傳輸 過程中還支援了AES-128 加密，進一步確保SITA 傳送資料的安全性． SITA 改良了TCP 檢查檔案完整性的機制，原本每一個封包傳送成功後，接收端會 向傳送端的主機回傳確認資料送達的「確認回應」。假如確認回應沒有送到傳送端的主 機，傳送端主機將會重複傳送資料，直到收到確認回應為止。SITA 將其簡化為在不中斷 封包傳送的前提下，定期要求接收端回報寄送端「應收到而未收到」的封包清單，在有 空閒的時候再傳送先前遺失的封包，只要最後所有的封包能出現在目的地組合成完整的 檔案，抵達順序並不會特別要求，讓SITA 中的封包傳送不間斷，又確保了檔案的完整 性（Synology, 2017）。 圖3-7 Presto File Server 的傳輸機制 資料來源：（Synology, 2017） Presto FS 除了高效傳輸之外，為了符合在商業環境上的應用，支援了AES-128 加密， 確保資料可以安全的傳輸。在傳輸任務的管理以及頻寬控管上的功能，也符合一般企業 所需。Client 端軟體則支援了主流的作業系統，包含Windows, Mac 和Linux，軟體的介面 簡潔且容易使用，不會造成管理者太大的負擔，這是Synology 軟體一直以來優勢。 Presto FS 授權不以端點數量及功能計價，單純只用頻寬大小來計價，個案公司要依 實際傳輸速率的需求來購買足夠的頻寬授權，因此採購前的效能測試數據，會決定未來 採購的成本。但其並非是純軟體解決方案，Server 端必須搭配其專屬硬體才能運行，好 在Synology 的儲存陣列選擇眾多，從小型支援2 顆硬碟的機種到大型支援數PB 的機種 皆有，可依企業對於效能、容量及預算的需求選擇適合的機種。整體來說Presto FS 在功 能上不像Signiant 般全面，只能基本滿足個案公司的需求，持有成本合理，但其綁定專 屬硬體的架構，會影響部署彈性。 經過軟體功能與持有成本兩方面評比之後，UDP 族群Tsunami、Presto FS 和Signiant 在頻寬利用率上都有出色表現，但Tsunami 的管理功能付之闕如。TCP 族群SFTP 與SMB 傳輸效能過差，管理功能也很陽春，基本上已排除在選項之列。Presto FS 與Signiant 各 方面評比互有領先，軟體功能基本上都可以滿足，但Presto FS 在佈署時需要採用Synology 的磁碟陣列，非純軟體解決方案，管理上缺乏彈性之外，也會提高未來擴充成本。最後 Signiant 以較為全面的功能與合理的持有成本勝出，各軟體評比如表3-2 所示。 表3-2 各軟體評比 資料來源：本研究 為了驗證UDP 傳輸加速軟體的效能究竟比傳統TCP 傳輸軟體好上多少？下一章節 將進行實驗環境架設及傳輸效能測試。 第四章 實驗 本實驗分成兩個階段，第一階段採用虛擬機技術，將Server 及Client 分別安裝在兩 台虛擬主機上。再使用WANem 來模擬不同國家彼此間的網路延遲及封包遺失率，驗證 各種傳輸軟體的傳輸效能。第二階段採用相同的虛擬機技術，實際分別在英國、中國、 台灣及美國的機房，安裝Server 及Client，透過MPLS 網路來做資料的傳輸，測試各種 資料傳輸軟體在跨國遠距的傳輸速率，並驗證實驗一用WANem 模擬的準確性。 4.1 WANem 廣域網路模擬器 WANem 是一套廣域網路（WAN）模擬工具，由印度TATA 公司的工程團隊所開發 的開源軟體，設計目的是在區域網路（LAN）中讓開發人員搭建廣域網路以及網際網路 的模擬環境，安裝好的WANem 可視為網路中的一個Gateway，該Gateway 可以模擬WAN 的特性，例如網路延遲、封包遺失、斷線、封包損壞、抖動（Jitter）等等。 WANem 下載後就是以一個可開機的ISO 檔案，新增一台虛擬機，掛載ISO 檔開機 後會進入如圖4-1 的IP 位址設定選單。設定好IP、Netmask、Default Gateway 之後即可透 過http://ip-address/WANem 進入Web UI 操作。 圖4-1 WANem IP 設定 資料來源：本研究
