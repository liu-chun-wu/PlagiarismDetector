在蒐集完台灣經濟新報資料庫資料後，本研究將採用以下資料預處理方法進 行變數的擷取與整理：移動視窗、資料標準化及資料平衡。  移動視窗 移動視窗 (rolling window) 為將資料集進行標定特定時間區間，並且在特定 時間區間內產生有價值之資訊，這些有價值資訊為歷史交易日開盤價、收盤價、 最高價、最低價、移動平均線等指標，實施移動視窗法前，須固定移動視窗大小， 才可對時間序列資料產生新的資料集，透過重複地逐日移動固定移動視窗過程， 每個時間區間會產生一筆新的資料樣本，產生新的樣本之間會有重疊，因此移動 視窗方法又稱為重疊移動視窗方法；移動視窗法過程如圖2，其中windowi， i=1,…；w 為移動視窗方法對於資料來源選定時間區間之範圍，以日為單位；Di 為第i 日之交易日；t 為移動視窗產生之樣本間的間隔距離，以日為單位。 圖 2、移動視窗法過程 -14- 本研究使用2010 年1 月1 日至2019 年8 月8 日每日股票資料，因此將所有 來自台灣經濟新報所抓取的資料分割為兩個大區間，分別為訓練期2010 年1 月 1 日至2014 年12 月31 日，測試期為2015 年1 月1 日至2019 年10 月15 日， 研究將對兩個大區間皆進行移動視窗方法產生新樣本，每個新樣本還會有所謂的 形成期與持有期，形成期會作為產生未來訓練模型之所需輸入變數，其本研究設 定大小為60（日），持有期則會產生成報酬率，其本研究設定大小為20（日）， 訓練期樣本將具有報酬率答案（輸出變數已知）之樣本進行建模，而測試期所產 生的樣本則是不具有報酬率答案（輸出變數未知）之樣本進行回測，透過訓練期 所訓練出之模型進行預測，再透過測試期實際個股歷史報酬率進行模型評估。  資料標準化 本研究因為資料集包含不同行業類別個股股票，各公司股票價格高低不一， 故須透過標準化方式，以方便後續分析，以及進行各行業的比較，標準化流程為 透過先前移動視窗產生一筆資料後，以移動視窗大小三個月 (60 天) 為例，透過 形成期第一天開盤價作為基數，此移動視窗每天的開盤價、最高價、最低價、收 盤價皆除以第一天開盤價，此計算結果作為每天各價格上漲和下跌幅度之變化 量。 (1) 其中Xn 為標準化股價，Xi,j 為形成期股價，i 為形成期第i 天股價，j 為四 種股價類別（j=0 為開盤價，j=1 為最高價，j=2 為最低價，j=3 為收盤價）。  資料平衡 在學術研究中，大多數的算法基本假設是數據分佈是平均的，但當把算法應 用於實際數據裡，大多情況下是無法達到理想化，所以當分類資料集中，某一類 別數據大於另一類別數據時，資料會產生不平衡分佈，進而影響到實驗本身，因 為建立出的預測模型，會偏向類別比較多的數據，導致訓練出來的模型失去判斷 能力，這種模型毫無價值可言。 -15- 解決資料不平衡問題，就是要改變樣本資料的分佈，最常用的方法有上採樣 (Oversampling) 及下採樣 (Undersampling) ，上採樣也就是增加少數法，是把小 類別樣本複製多份，達到與大類別樣本的資料數相同；下採樣也就是減少多數 法，是從大類別樣本中選取部分樣本，達到資料平衡；本研究採用減少多數法， 將大類別樣本隨機減少至小類別樣本數量，以解決資料不平衡問題。
