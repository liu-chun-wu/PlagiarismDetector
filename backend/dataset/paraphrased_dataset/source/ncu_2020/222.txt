深度學習對於自然語言處理及圖像辨識的能力吸引了許多研究領域的關注，例如在 惡意程式分析領域中，許多研究嘗試將惡意程式轉換為圖像，並以圖像辨識的模型來分 類惡意程式。在2011 年，[51]將Windows 惡意程式的二進制檔案轉換為灰階圖片，並 發現同一個惡意家族中的樣本具有非常相似的紋理特徵，因此發展出了一個將惡意程式 直接圖像化且不需要反編譯惡意程式或是實際執行程式碼即可分類惡意程式的方法。 [51]首先將惡意程式的二進制檔案轉換為每8 個bit 為一組的向量，接著將每個8-bit 向 量轉換成十進位，轉換後的值介於0 到255 之間，而這些值則依序填入灰階圖像中的每 個像素，每一個像素的值都決定了像素的明暗度，數值愈大則顏色愈亮，數值愈小則顏 色愈暗，惡意程式的每個十進制的值填入灰階圖像的像素之後，將形成一張屬於此惡意 程式的灰階圖像，如圖 4 所示，為Windows 木馬程式下載器Dontovo A 的灰階圖像， 可以看到在將Windows 惡意程式的二進制檔案轉換為灰階圖像後，灰階圖像中的不同 區塊中各有不同樣式的紋理，而這些不同樣式的紋理則對應到了二進制檔案中不同區塊 的程式碼，其中.text 區塊包含可執行的程式碼，.data 區塊包含初始化的程式碼及資 料，.rsrc 區塊包含了所有模組中的資源；圖 5 則是Windows 惡意家族Fakerean 及Dontove A 的灰階圖紋理，其中第一列為Fakerean 惡意家族中的三個惡意程式，第二列為Dontove 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 A 惡意家族中的三個惡意程式，可以看出同個惡意家族中的惡意程式灰階圖像，具有圖 像紋理相似的特性。 圖 4  Dontove A 灰階圖 （圖片來源：[51]） 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 圖 5  Windows 惡意家族Fakerean（上）及Dontove A（下）紋理特性 （圖片來源：[51]） 在Android 惡意程式領域中，也有相關研究將Android 惡意程式轉換為圖像[52]， 但與[51]直接將整個Windows 惡意程式轉換為二進制檔案的做法不同，由於Android 應 用程式為apk 檔案格式，是一種壓縮檔的形式，並不像Windows 的檔案中有程式區塊的 概念，因此將整個Android 惡意程式轉換為灰階圖像的紋理並不明顯，如圖 6 所示。 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 圖 6  apk 檔案直接轉換成灰階圖像 （圖片來源：[52]） 為了讓Android 惡意程式轉換為灰階圖像的紋理能夠更明顯，[52]首先將apk 檔案 解壓縮，萃取出classes.dex、AndroidManifest.xml、resources.arsc 及CERT.RSA 等四個檔 案，再以[51]的做法將四個檔案分別都轉換成灰階圖像，最後將四張灰階圖像拼接在一 起成為最後代表此apk 檔的灰階圖像。如圖 7 所示，為Android 惡意家族GeiNiMi.L 中 的惡意程式灰階圖像，與Windows 惡意程式轉換為灰階圖像相似，可以看到以四個檔案 組成的Android 惡意程式灰階圖像中，不同檔案對應到的圖像區塊都有著不一樣的紋理。 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 圖 7  Android 惡意家族GeiNiMi.L 中的灰階圖像 （圖片來源：[52]） [53]將Android 惡意程式轉換為RGB 圖像，首先將classes.dex 檔中十六進制的byte- code 轉換成十進制，並以3 個已轉換成十進制的bytecode 為一組，將每組中的3 個十進 制的值依序填入RGB 圖像的像素，3 個十進制的值分別對應到同個像素位置的三個色 彩通道，形成RGB 圖片，圖 8 為2 個不同Android 惡意家族的RGB 圖片，同一列為屬 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 於同個惡意家族中的惡意程式，可以看出同一個惡意家族的惡意程式轉換成RGB 圖片 具有較相似的紋理。 圖 8  Android 不同惡意家族的RGB 圖片 （圖片來源：[53]） [54]將Android 惡意家族及iOS 惡意家族轉換為灰階圖像，圖 9 為Android 惡意家 族DroidKungFu 中4 個惡意程式的灰階圖片，圖 10 為iOS 惡意家族AccDeceiver 中2 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 個惡意程式的灰階圖片，可以看到除了Android 惡意家族外，iOS 惡意家族同樣具有相 同惡意家族的惡意程式經過圖像化轉換具有相似紋理的特性。 圖 9  Android 惡意家族DroidKungFu 中4 個變種的灰階圖片 （圖片來源：[54]） 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 圖 10  iOS 惡意家族AceDeceiver 經過灰階轉換的2 個樣本 （圖片來源：[54]） 以上研究顯示，不管是Windows 系統、Android 系統，甚至在iOS 系統中，將惡意 程式轉換成圖像之後，屬於同個惡意家族中的惡意程式都具有相似的紋理特徵，而這種 特色使得能將處理圖像辨識任務的卷積神經網路應用在惡意家族分類中，將惡意家族分 類視為圖像辨識分類任務。
