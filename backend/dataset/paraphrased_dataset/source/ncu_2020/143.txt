本次研究中使用Orange 資料探勘工具，套件如：Data 模組中的File、Select Rows 用來讀取及選擇資料，資料預處理包括Data Sampler(數據採樣)、 Concatenate(數據合併) 及Rank 自變數重要性排序， Model 模組中包括kNN、 DT、SVM、SGD、RF、ANN、NB、LGR 及AdaBoost 用來建立模型，Evaluate 模組中Test and Score、Confusion Matrix 用來進行模型測試與評估；實驗環境採 用(1)處理器：Intel(R) Core(TM) i5-6200U CPU @ 2.30GHz   2.40 GHz；(2)顯示 卡：AMD Radeon(TM) R5 M330；(3)記憶體：8GB。 實驗資料集數據如表7，本研究僅針對957 家中，自2010 年至2019 年皆上 市的公司進行分析，產業涵蓋化學工業等28 種產業，公司數合計796 家，資料 集（訓練集和測試集）合計1,160,621 筆。依變數為報酬率趨勢，屬於類別型態， 設定上漲界線為超過5%，其餘為其他類，訓練集上漲類167,870 筆，其他類 168,394 筆，測試集上漲類151,555 筆，其他類672,802 筆，實驗建立模型前會針 對訓練資料集進行減少多數法資料平衡方式，將依變數各類別個數調整成相同數 量。 表 7、實驗資料集一覽表 產業類別 公司數 訓練集 合計 測試集 合計 rise other rise other 化學工業 4,349 5,341 9,690 3,272 20,503 23,775 水泥工業 1,311 1,751 3,062 6,124 7,059 半導體業 13,827 11,647 25,474 14,285 47,203 61,488 生技醫療業 4,200 4,149 8,349 4,748 21,652 26,400 光電業 13,120 11,181 24,301 14,185 47,038 61,223 汽車工業 4,777 3,459 8,236 4,325 17,595 21,920 其他業 10,113 9,347 19,460 8,786 40,074 48,860 其他電子業 8,321 7,411 15,732 8,167 28,976 37,143 油電燃氣業 1,566 2,520 4,485 5,131 金融保險業 4,848 7,727 12,575 3,874 32,470 36,344 建材營造業 10,429 10,141 20,570 8,232 42,463 50,695 -28- 產業類別 公司數 訓練集 合計 測試集 合計 rise other rise other 玻璃陶瓷 1,723 4,726 5,456 食品工業 4,386 4,962 9,348 3,349 18,240 21,589 紡織纖維 9,987 9,709 19,696 6,961 32,047 39,008 航運業 3,432 4,469 7,901 3,125 17,602 20,727 通信網路業 8,211 7,428 15,639 8,508 29,271 37,779 造紙工業 1,372 2,286 1,179 5,165 6,344 貿易百貨業 3,041 3,011 6,052 2,713 13,450 16,163 塑膠工業 4,318 4,354 8,672 3,331 18,172 21,503 資訊服務業 2,407 2,684 5,091 1,883 10,332 12,215 電子通路業 3,478 4,739 8,217 2,636 17,814 20,450 電子零組件業 19,820 18,439 38,259 21,132 70,555 91,687 電腦及周邊設備業 11,734 10,453 22,187 11,212 42,813 54,025 電器電纜 2,051 3,304 5,355 2,561 11,431 13,992 電機機械 8,041 6,871 14,912 6,901 27,310 34,211 橡膠工業 2,243 2,340 4,583 1,588 9,264 10,852 鋼鐵工業 4,944 6,855 11,799 436 25,119 25,555 觀光事業 1,859 2,716 4,575 1,855 10,908 12,763 合計 167,870 168,394 336,264 151,555 672,802 824,357 本實驗自變數總共258 個，分別為前60 個交易日開盤價、最高價、最低價、 收盤價、資產報酬率、淨值報酬率、稅後淨利率、負債權益比、資產負債率、移 動平均線、加權移動平均、指數平滑移動平均、指數平滑異同移動平均線、相對 強弱指標、能量潮指標、動量指標、威廉指標、融資餘額、融券餘額、外資買賣 超、投信買賣超及自營買賣超，僅股價進行標準化，餘變數皆為常態分配。 表 8、自變數對照表 自變數項次 類別 欄位說明 1-240 股價 前60 個交易日開盤價、最高價、最低價、收盤價 基本面 資產報酬率 淨值報酬率 稅後淨利率 負債權益比 資產負債率 技術面 移動平均線 加權移動平均 指數平滑移動平均 指數平滑異同移動平均線 -29- 自變數項次 類別 欄位說明 相對強弱指標 能量潮指標 動量指標 威廉指標 籌碼面 融資餘額 融券餘額 外資買賣超 投信買賣超 自營買賣超 圖4 為實驗一設計流程圖，將2010 年至2019 年股價資訊等資料集，區分訓 練集(2010 年至2014 年)及測試集(2015 年至2019 年)，再區分化學工業等28 種 產業類別，分別將訓練集使用資料平衡化技術，使依變數(上漲類與其他類)各類 別筆數相同，再使用機器學習演算法建立模型，並利用交叉驗證及混淆矩陣實施 模型評估。 圖 4、實驗一設計流程圖 圖5 為實驗二設計流程圖，根據實驗一架構，將資料集區分基本面、技術面 及籌碼面三個資料集，區分訓練集(2010 年至2014 年)及測試集(2015 年至2019 年)，再區分化學工業等28 種產業類別，分別將訓練集使用資料平衡化技術，使 依變數(上漲類與其他類)各類別筆數相同，再使用機器學習演算法建立模型，並 利用交叉驗證及混淆矩陣實施模型評估，探討三種面向變數有較好的預測能力。 -30- 圖 5、實驗二設計流程圖 圖6 為實驗三設計流程圖，根據實驗一架構，僅使用基本面、技術面及籌碼 面等18 個變數，區分化學工業等28 種產業類別，分別將訓練集使用資料平衡化 技術，使依變數(上漲類與其他類)各類別筆數相同，再使用機器學習演算法建立 模型，並利用交叉驗證及混淆矩陣實施模型評估。 圖 6、實驗三設計流程圖 圖7 為實驗三取重要排序流程圖，根據實驗三架構，使用變數重要性排序， 取前五名變數，探討特徵選取後，是否比原始實驗三有較好的預測能力。 圖 7、實驗三選取重要性排序變數流程圖 -31-
