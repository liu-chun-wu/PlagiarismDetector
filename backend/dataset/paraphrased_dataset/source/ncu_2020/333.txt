為了解決傳統方法在偵測上效果不夠好且費時的問題，Girshick et al. [11] 提出了區域卷積神經網路 R-CNN (regions with CNN features)。R-CNN 以選擇性搜索 (selective search) [27] 方法，產生數千個可能含有物體的候 選區域，再將這些區域透過卷積神經網路提取特徵，最後再輸入支援向量 機 (support vector machine, SVM) 進行分類。流程如圖2.1 所示。但由於 每個候選區域都必須被個別輸入卷積神經網路中提取特徵，導致速度仍 然緩慢。 圖 2.1. R-CNN 網路架構。 由於 R-CNN 仍有許多缺陷，所以在微軟工作的Girshick 在2015 年 提出了快速區域卷積網路 Fast R-CNN (fast region-based convolutional networks) [12] 改善R-CNN 速度。作者不再對每個區域重複做特徵提取 的動作，而是將整張影像輸入到網路，只做一次提取特徵，因此省去了個 - 7 - 別提取特徵的時間。此後需再把候選區域的的特徵輸入全連接層 (Fully connected layer) 進行預測，如圖 2.2 所示。但是全連接層必須接受固定 大小的輸入，為了能將不同大小候選區域的特徵輸入全連接層進行預測， 作者借鑒空間金字塔池化 (spatial pyramid pooling, SPP) [28] 提出感興趣 區域池化層 (RoI pooling layer)，用以將不同大小候選區域所涵蓋的特徵 統一轉為固定大小的數據輸入至全連接層。在分類上，支援向量機改換成 歸一化指數函數 (softmax function) 替代進行分類。而在位置上，物件的 定界框 (bounding box) 則是以迴歸得出最終結果。 圖 2.2. Fast R-CNN 網路架構。 後來Ren et al. [13] 以 Fast R-CNN 為基礎進一步提出 Faster R-CNN (faster region-based convolutional networks)，以區域建議網路 (region proposal network, RPN) 取代原本 Fast R-CNN 的選擇性搜索來提出候選 區域，此架構的提出使物件偵測與辨識能全部以卷積神經網路架構來達 成，流程如圖 2.3 所示。 - 8 - 圖 2.3. Faster R-CNN 網路架構。 物件偵測可分為兩部份，一是定位 (object localization) 物件，而另一 個是對物件進行分類 (classification)。以R-CNN 為主的卷積神經網路將 定位和分類分別訓練，因此被稱作二階段網路，而Liu et al. [17, 18] 提出 了SSD (single shot multi-box detector network)，此網路能僅透過一個卷積 神經網路就同時完成偵測和分類。不同於 Faster R-CNN 有 RPN 這個分 支網路來提出候選區域，SSD 這類的網路被稱作一階段網路。SSD 以多 尺度的特徵圖進行物件偵測，如圖 2.4 所示。大尺度特徵圖為低階特徵 圖，小尺度特徵圖為高階特徵圖。低階特徵圖經過的卷積層與降維次數較 少，因此每個像素的感受野 (receptive field) 較小，所以適合用來偵測小 物件，而高階特徵圖經過的卷積層與降維次數較多，因此每個像素的感受 野較大，所以適用來偵測大物件。SSD 採取使用高中低階特徵圖個別進 - 9 - 行偵測，此種作法能顧及各種大小的物件，因此結果比起使用單一尺度特 徵圖進行偵測的模型來的更準確。 圖 2.4. SSD 網路架構。 Redmon et al. [14] 將物件偵測視為一個迴歸問題，提出了 YOLO (you only look once)，與 SSD 皆為一階段的物件偵測系統。YOLO 把影 像切為小方格 (grid)，如圖 2.5 所示，再針對每個方格來判斷是否有物件， 若有物件則預測該物件的類別及大小，相較於二階段網路來說不必先預 測出候選區塊，所以一階段網路更快。 - 10 - 圖 2.5. YOLO 偵測及分類流程。 Redmon 和 Farhadi 隔年再提出 YOLOv2 (YOLO 9000) [15]，如圖
