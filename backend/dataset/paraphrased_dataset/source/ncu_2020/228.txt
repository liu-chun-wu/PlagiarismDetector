為了以深度卷積生成對抗網路生成少樣本惡意家族中的樣本，將經由特徵向量化模 組生成的Opcode 特徵向量、API 特徵向量及Permission 特徵向量，輸入至RGB 圖片生 成模組以生成對應的RGB 色彩通道，並結合成最終的RGB 圖片。由於RGB 圖片的三 個色彩通道大小需一致，下列說明三個色彩通道的大小如何決定及各特徵向量如何轉換 成色彩通道的過程。 在生成紅色、綠色及藍色通道之前，首先需要決定最終RGB 圖片的長與寬大小， 而RGB 圖片的長與寬也等同於三個色彩通道的長與寬大小。由於Opcode 特徵向量的長 度較API 特徵向量及Permission 特徵向量都較長，本研究將使用Opcode 特徵向量長度 的根號值當作三個色彩通道的長與寬的基準。舉例來說，若有一Android 應用程式的 Opcode 特徵向量長度為50,000，則取50000 為3 個色彩通道的長與寬的基準。 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 有了色彩通道長與寬的基準後，接著決定最終RGB 圖片大小的長與寬。將基準與 API 特徵向量及Permission 特徵向量的長度進行比較，若此基準較API 特徵向量及 Permission 特徵向量的長度都較長，則取此基準為最終三個色彩通道的長與寬；若此基 準小於API 特徵向量或Permission 特徵向量的長度，那麼將以API 特徵向量或Permission 特徵向量中較長的長度為最終三個色彩通道的長與寬，紅色通道、綠色通道及藍色通道 則以此長與寬生成二維矩陣。此做法是為了確保RGB 圖片中有足夠的像素讓Opcode 特 徵向量、API 特徵向量及Permission 特徵向量中的值能夠被填入。 以圖 15 為例，某一Android 應用程式的Opcode 特徵向量長度為n，取n 的根號 n 為基準，若n 同時大於API 特徵向量及Permission 特徵向量，則以n 當作RGB 圖片的長與寬；若API 特徵向量及Permission 特徵向量中較長的向量長度大於n ，則 以此較長的長度當作RGB 圖片的長與寬。 圖 15  RGB 圖片的長與寬設定 （圖片來源：本研究） 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 RGB 圖片中的紅色通道由Opcode 特徵向量所組成，將Opcode 特徵向量中每個索 引對應到的值（Opcode 十六進制轉十進制之後的值）依序填入紅色通道中。填入的方法 為以填滿二維矩陣的列為優先，依序將Opcode 特徵向量中的值填入紅色通道二維矩陣 中，此方法可視為將Opcode 特徵向量中的每個值依序從紅色通道圖片的最左上角的一 塊像素依序填入至最右下角的最後一塊像素，若是未填滿整個紅色通道圖片，空的像素 則以補0 的方式補滿，此紅色通道圖片包含了一個Android 應用程式的Opcode 序列語 意關係。 RGB 圖片中的綠色通道由API 特徵向量所組成，將API 特徵向量中非0 的值填入 綠色通道二維矩陣中。填入的方法為將API 特徵向量中非0 的值對應到的索引映射到綠 色通道二維矩陣中的「列」，再將被映射到的整個列填入此非0 的值，而為了讓綠色通 道的紋理能夠更明顯，將非0 的值乘以10 倍之後再填入。 以圖 16 為例，此Android 應用程式的API 特徵向量中，非0 的值分別為8、20 及 16，對應到的索引分別為索引2、索引4 及索引5，將2、4 及5 這3 個數字對應到綠色 通道二維矩陣中的「列」 ，即第二列、第四列及第五列，分別將8、20 及16 乘以10 倍 依序填到這些列中，即第二列的每個像素值都填上80、第四列的每個像素值都填上200 及第五列的每個像素值都填入180。 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 圖 16  API 特徵向量轉換綠色通道過程 （圖片來源：本研究） RGB 圖片中的藍色通道由Permission 特徵向量所組成，將Permission 特徵向量中非 0 的值填入藍色通道二維矩陣中。填入的方法為將Permission 特徵向量中非0 的值對應 到的索引映射到藍色通道二維矩陣中的「欄」，再將映射到的整個欄填入此非0 的值， 而為了讓藍色通道的紋理能夠更明顯，將非0 的值乘上15。 以圖 17 為例，此Android 應用程式的Permission 特徵向量中，非0 的值分別為12、 8 及15，對應到的索引分別為索引1、索引2 及索引n-1，將1、2 及n-1 這3 個數字對 應到藍色通道二維矩陣中的欄 ，即第一欄、第二欄及最後一欄，分別將12、8 及15 乘 以10 倍依序填到這些欄中，即第一欄的每個像素值都填上180、第二欄的每個像素值都 填上120 最後一欄的每個像素值都填入150。 圖 18 為Adrd 家族中其中一個惡意程式轉換為RGB 的圖片。 結合多特徵及深度學習擴增技術提升Android 小樣本惡意家族分類能力 圖 17  Permission 特徵向量轉換藍色通道過程 （圖片來源：本研究） 圖 18  Adrd 家族RGB 圖片 （圖片來源：本研究）
