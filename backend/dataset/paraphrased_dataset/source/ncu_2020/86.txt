為了避免車輛發生碰撞，預測鄰近車輛軌跡為其中重要任務之一，近年來，此領 域已經廣泛研究，提出許多預測車輛及物體軌跡的方法，包含經典方法、交互作用及 基於深度學習的方法等，不僅是利用過去的歷史資料進行軌跡或行為的預測，更需加 強訓練和鄰近車輛的交互作用，以因應更多的突發狀況發生。 2.1.1. 經典軌跡預測的方法 通過對象追蹤的技術，車輛運動模型，例如：運動學模型、動態模型，已用於軌 跡預測(Ammoun & Nashashibi, 2009)，在最早期的方法中，由於觀察通常受到限制， 而使用線性模型模擬物體軌跡的不可預測性，例如：卡爾曼濾波器(Kalman Filters)(Kalman, 1960)，它能夠從包含雜訊的測量中，考慮各個時間下的聯合分布，以 估計動態系統的狀態，因此被廣泛使用在有關時間序列的應用，然而當所有的狀態並 非能完全觀察，但受狀態影響的某些參數是可見時，便可以透過HMM(Firl, Stübing, Huss, & Stiller, 2012)進行預測，求得最後時刻各個隱含狀態的機率分布。 許多經典的方法中，用到了統計機率的理論，例如：貝葉斯公式(Bayesian formulation) (Lefèvre, Laugier, & Ibañez-Guzmán, 2011)，可以在具有已知的條件下，預 測事件發生的機率，另外，蒙特卡洛模擬(Monte Carlo simulation) (Danielsson, Petersson, & Eidehall, 2007)則是類比事件中隨機的過程，能夠將所需預測的問題轉化為隨機分布 的特徵數。 上述方法多利用統計學的基礎，並著重於根據自身的歷史資料以分析特定狀態發 生的機率，但在密集複雜的動態環境中，因不可控之因素較多，無法確實地模擬車輛 之間的交互關係，Trautman & Krause (2010)發現未對車輛之間的交互進行建模的方法， 其準確性較差，且這些方法在考慮車輛的物理限制的情況下，通常對於短期軌跡預測 有效，但對於長期預測而言卻不夠準確。 2.1.2. 行為模式與交互作用 根據上一小節的敘述，由於許多方法無法適應於如此複雜的環境，因此，在另一 項領域則是透過車輛之間的顯式或隱式交互進行建模，當環境中擁有諸多類型的物體， 透過觀測其行為模式和彼此之間的互動方式，可以知道慣性的運動模式，能夠提高軌 跡預測的準確率。 關於交互作用的建模中有許多的示例，最早為了瞭解關於人類行為和互動的方式， 由Helbing & Molnar (1995)提出具有吸引力和排斥力的社交力量(Social Force)模型，從 心理學的角度重新解釋基於物理學的模型，可用於分析不同場景的行人運動模式，例 如：購物中心、廣場和步行街，將這些考慮個人、社會及環境的隱藏特性納入公式中， 進而準確地預測行為(Yamaguchi, Berg, Ortiz, & Berg, 2011)。 延伸至交通場景中，Ma, Manocha, & Wang (2018)提出在複雜的異構道路中，考慮 運動學和動態約束來預測多個道路代理的軌跡，並基於速度和速度上的相互影響，通 過計算無碰撞導航來模擬異構交通的道路代理，但此模型假定所有的交通代理皆需明 確地感測及有完整的形狀和運動軌跡的數據，而這些具有恆定速度或恆定加速度假設 的現有運動模型不能正確地模擬密集的場景，因為沒有考慮避免碰撞的行為，往復速 度障礙(Reciprocal velocity obstacles, RVO)可以應用於人群中以及密集交通環境中的行 人(Van Den Berg, Guy, Lin, & Manocha, 2011)，為了也能夠實踐於包含汽車，公共汽車， 行人，兩輪摩托車甚至是動物的密集且異構的交通場景中，非線性RVO 運動模型可 代替恆定速度模型(Van den Berg, Lin, & Manocha, 2008)。 另外，有些方法則是基於圖形解釋彼此之間的交互關係，Chandra et al. (2020)結合 頻譜圖分析和深度學習，提出了一種在城市交通場景中進行交通預測的新穎方法，從 每個道路代理的軌跡中提取低階訊息（未來軌跡）和高階訊息（車輛行為），並且使用 動態加權流量圖表示交通代理之間距離的接近程度；Guo, Lin, Feng, Song, & Wan (2019)提出一種基於注意力的時空圖卷積網絡(Attention Based Spatial-Temporal Graph Convolutional Networks, ASTGCN)模型，解決高度非線性和複雜的交通流量預測問題， 並對交通數據的動態時空相關性進行建模。 駕駛者意圖也常被用來預測車輛可能的運動模式，促成不同駕駛員行為類別的因 素大致分為四類，第一類因素與駕駛員相關，包含駕駛員的特徵，例如：年齡，性別， 血壓等；第二類對應於環境因素，例如：天氣或交通狀況，Jamson, Merat, Carsten, & Lai (2013)在對於密度不同的交通狀況，具有高度車輛自動化的駕駛者是否願意改變車道； 第三類對應於心理層面，可能包含酒後駕駛、疲勞狀態等；第四類對應於環車輛因素， 例如：位置、加速度、速度、車道變化等，前三類不易取得所需的資料，最後一類為 多數方法常用來判斷的參考因素，例如：Cheung, Bera, Kubin, Gray, & Manocha (2018) 可以自動從車輛軌跡中識別駕駛者的行為，利用加速度和車道跟隨等相關的軌跡特徵 找出對應的行為模式，可用來分類為激進、保守、謹慎等不同類型的行為標籤，Xin et al. (2018)提出可以在車輛改變車道之前的幾秒鐘識別駕駛者意圖的模型，該方法可以 利用駕駛數據通過序列學習自動學習駕駛員行為的高階時空特徵。 2.1.3. 基於深度學習的方法 近年來，深度神經網絡的概念在許多領域有著良好的表現而受到了廣泛的關注， 而遞迴神經網絡(Recurrent Neural Networks, RNN)為DNN 的架構之一，用於許多領域 的序列生成，包括語音識別、機器翻譯和圖像字幕等，RNN 更是在時間序列預測有良 好的成效，但由於RNN 無法建立模型於長期序列，因此，許多車輛軌跡預測的方法 都使用長短期記憶網路(Long Short-Term Memory, LSTM)來建立模型。 Kim et al. (2017)透過感測器測量獲得的車輛座標序列提供給LSTM，並在柵格圖 上生成有關車輛未來位置的機率，並且可以通過深度神經網絡模型從大量的軌跡數據 中學習車輛的複雜行為，提出一種可以實時生成周圍車輛的未來軌跡序列，採編碼器 －解碼器(Encoder-Decoder)架構，該架構使用基於LSTM 的編碼器來分析過去軌跡中 的模式，並使用基於LSTM 的解碼器來生成未來的軌跡序列，在柵格圖上生成K 個最 可能的軌跡候選對象，最後，將K 個最佳候選對象由解碼器輸出，但這些基於採樣的 方法由於柵格的長度為10 公尺的離散度限制，因此，犧牲位置預測的準確性，且資料 集僅有路徑較一致的高速高路為例。 然而LSTM 不僅適用於車輛的軌跡預測，在ADAS 和自然駕駛的研究中，都已將 車輛運動劃分為操作分類(Maneuver Classification)的問題，因此，Deo & Trivedi (2018b) 提出基於LSTM 產生鄰近車輛的未來軌跡，用於高速公路上周圍車輛的交互感知運動 預測，為車輛執行的操作分配置信度，並基於此數值在未來運動中輸出多模式的分布， 以下將介紹和LSTM 結合之混合式模型。 因應其他深度學習技術的發展，每種架構皆有各自的優勢，對於許多不同的任務 要求，便能夠將各個架構的優勢結合起來，形成許多預測效果更加的混合式模型，在 行人路徑預測方面，行人遵循不同的軌跡避開障礙物並容其他的行人，倘若在此場景 中導航的任何自駕車皆需能夠預見行人的未來位置，且相應地調整行進路線以避免碰 撞，因此，Alahi et al. (2016) 將上述的交互作用結合LSTM 產生社交型 LSTM(Social-LSTM)的模型，因應每個人以不同的速度和加速度運動且具有不同的步 調，因此，對於場景中的每個人，都有一個屬於自己的LSTM，用來學習人的狀態並 預測其未來的位置，並利用隱藏狀態(Hidden state)的社交池化(Social pooling)計算行人 在移動中基於社交作用的軌跡，其之間的權重皆為共享的，通過最小化負對數似然 (Negative Log Likelihood ,NLL)的損失來學習LSTM 模型的參數，如公式(1)所示： 𝐿𝑖(𝑊𝑒, 𝑊𝑙, 𝑊𝑝) = − ∑ log (ℙ(𝑥𝑡 𝑖, 𝑦𝑡 𝑖|𝜎𝑡 𝑖, 𝜇𝑡 𝑖, 𝜌𝑡 𝑖)) 𝑇𝑝𝑟𝑒𝑑 𝑡=𝑇𝑜𝑏𝑠+1 (1) 假設下一個時間步(Time-step)中以多變量高斯分布(Bivariate gaussian distribution)， 由標準差(𝜎)、平均數(𝜇)、相關係數(𝜌)來調整參數，𝑥𝑡 𝑖, 𝑦𝑡 𝑖為𝑖𝑡ℎ軌跡的位置座標。 圖 1 為Social-LSTM 方法架構，此概念常為往後的相關研究引用，包含本篇論文 亦是此方法之延伸，當然，也能夠應用於車輛軌跡預測的領域(Deo & Trivedi, 2018a)， 且結合更多新興的深度學習方法，如與生成對抗網絡(Generative Adversarial Network, GAN)結合的Social-GAN 模型，也用於人群中行人的軌跡預測(Gupta, Johnson, Fei-Fei, Savarese, & Alahi, 2018)，另外，尚有許多將深度學習方法應用於車輛軌跡預測的方法， 利用強化學習(Reinforcement Learning, RL)預測駕駛者行為的機率(L. Sun, Zhan, & Tomizuka, 2018)和建立車輛避免碰撞的基準(Behzadan & Munir, 2019)。 圖 1 社交型LSTM(Social-LSTM)方法架構 每位行人的隱藏狀態ℎ𝑖(代表𝑖𝑡ℎ行人的隱藏狀態)通過S-Pooling(Social pooling)隱式推理鄰近的其他行人 的運動模式以調整自身的路徑，而這些行人也受到周圍環境其他人的影響。 CNN 已經成功地應用於許多電腦視覺領域，例如：物體識別(Zhao, Zheng, Xu, & Wu, 2019)，而在交通領域，為了在複雜的交通道路上解析道路代理及車道資訊，便利 用此提取其特徵，例如：Djuric et al. (2018)生成附近車輛和周圍環境(車道邊界)的光柵 圖像，再利用CNN 在影像中萃取其特徵以預測自身未來三秒的軌跡；Chou et al. (2019) 將高清地圖和車輛周圍環境光柵化為鳥瞰圖像，作為ConvNets 的輸入。 另一方面，則是利用CNN 對於圖像進行語義分割的能力，Huang et al. (2016)挑戰 視覺路徑預測的問題，利用這些視覺特徵執行時空語境(Spatio-Temporal Context)建模， 其目標是推斷靜態場景中視覺對象的未來路徑，需要對影片中的場景和運動模式都具 較高的語義理解，再用空間比對網路(Spatial Matching Network)在整個場景圖像上使用 滑動窗口(Sliding window)來裁剪局部環境，每個時間點皆用對象車輛和場景地的裁剪 後圖片計算空間語境的相似度。 LSTM-CNN 模型結合兩者的優勢，因此，在交通領域也廣為應用，Duan, Yang, Zhang, Ni, & Bajgain (2018)考慮到城市交通數據的非線性和時空特徵，將此模型用於 出租車GPS 軌跡的城市交通流量預測；Chandra, Bhattacharya, Bera et al. (2019)也提出 LSTM-CNN 的混合網路以學習車輛之間的互動關係，為了在異構交通的情況下預測車 輛的軌跡，即需要道路代理的空間坐標的時間序列，LSTM 是可以捕獲時間序列數據 中時間依賴性的模型，但由於每個LSTM 的參數都彼此獨立，因此LSTM 無法學習各 種異構道路代理的依存關係；在這方面，ConvNet 可以從圖像中學習局部依賴的特徵， 因此，為了利用兩者的優勢，將ConvNet 與LSTM 互相結合，以了解異構道路代理之 間在空間和時間方面的關係，本論文亦是參考此架構再加以改良。
