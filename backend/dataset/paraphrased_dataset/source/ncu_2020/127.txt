根據研究背景與動機，本研究利用公司股價(開盤價、最高價、最低價及收 盤價)、基本面、技術面及籌碼面作為輸入變數，並以K-近鄰演算法(kNN)、決策 樹(DT)、支援向量機(SVM)、隨機梯度下降法(Stochastic gradient descent, SGD)、 隨機森林(Random Forest, RF)、人工神經網路(Artificial Neural Network, ANN)、 單純貝氏分類器(Navie Bayes, NB)、邏輯式迴歸(Logistic Regression, LGR)及 AdaBoost (Adaptive Boosting)等九種機器學習方法建立預測模型，故本研究目的 共有以下三點： -4- (1) 使用K-近鄰演算法、決策樹、支援向量機、隨機梯度下降法、隨機森林、 人工神經網路、單純貝氏分類器、邏輯式迴歸及AdaBoost等九種機器學 習演算法作為預測模型方法。 (2) 探討各股60天股價（開盤價、最高價、最低價、收盤價）、基本面、技 術面及籌碼面等技術指標做為自變數對於預測模型建構的影響。 (3) 分析台灣證券交易所在化學工業等28種產業在K-近鄰演算法等9種機器 學習演算法有效性。 -5- 第二章 文獻探討 近年來，除了資訊硬體快速發展外，大數據分析、機器學習、深度學習等人 工智慧科技也有顯著進展，使得人們在有效地擷取大量數據的特徵，並且透過適 當的演算模型運作之後，可以有效地預測未來該類數據領域的發展。因此運用傳 統監督式機器學習或深度學習等技術，建立股票市場預測模型的相關研究文獻也 越來越多元。 本研究針對股價預測與機器學習相關國外文獻進行探討，並著重於文獻裡所 使用機器學習演算法做整理，表2 為機器學習演算法應用於股票市場相關研究文 獻一覽表，表3 為各文獻使用面向統整表。 -6- 表 2、機器學習應用於股票市場相關研究 作者 年份 國別 資料研究期間 分析技術 kNN DT RF SVM LGR NB ANN SVR Tan et al. 中國 2013 年2 月8 日至2017 年8 月8 日 V V Namdari and Li 美國 2012 年6 月至2017 年12 月 V Beyaz et al. 美國 1996 年1 月至2015 年12 月 V V Chen and Hao 中國 2008 年10 月31 日至2014 年12 月31 日 V V Henrique et al. 巴西 美國 中國 2002 年5 月至2017 年5 月 V Basak et al. 美國 各股票上市時間至2017 年2 月3 日 V V Chen and Hao 中國 2012 年5 月2 日至2014 年5 月31 日 V V Barak et al. 伊朗 2002 年至2012 年 V V Fu et al. 中國 2012 年8 月8 日至2013 年3 月8 日 V V Zhang et al. 中國 2005 年1 月31 日至2017 年4 月28 日 V Zhong and Enke 美國 2003 年5 月31 日至2013 年5 月31 日 V Patel et al. 印度 2003 年1 月至2012 年12 月 V V V V Kumar et al. 印度 各股票上市時間至2017 年2 月3 日 V V V V Weng et al. 美國 2012 年5 月1 日至2015 年6 月1 日 V 註：SVR 支援向量迴歸(Support Vector Regression) -7- 表 3、各文獻使用面向統整表 作者 年份 國別 資料研究期間 指標面相 股價 基本面 技術面 籌碼面 Tan et al. 中國 2013 年2 月8 日至2017 年8 月8 日 V V Namdari and Li 美國 2012 年6 月至2017 年12 月 V V Beyaz et al. 美國 1996 年1 月至2015 年12 月 V V Chen and Hao 中國 2008 年10 月31 日至2014 年12 月31 日 V V Henrique et al. 巴西 美國 中國 2002 年5 月至2017 年5 月 V Basak et al. 美國 各股票上市時間至2017 年2 月3 日 V V V Chen and Hao 中國 2012 年5 月2 日至2014 年5 月31 日 V V Barak et al. 伊朗 2002 年至2012 年 V Fu et al. 中國 2012 年8 月8 日至2013 年3 月8 日 V Zhang et al. 中國 2005 年1 月31 日至2017 年4 月28 日 V Zhong and Enke 美國 2003 年5 月31 日至2013 年5 月31 日 V Patel et al. 印度 2003 年1 月至2012 年12 月 V V Kumar et al. 印度 各股票上市時間至2017 年2 月3 日 V V -8- Tan et al. (2019) 使用隨機森林、邏輯式迴歸及深度神經網路等模型預測中 國股票市場所有上市公司的長期與短期價格趨勢，運用來自Wind 金融資料庫的 資料集，資料集包含價格、數量和上市公司的基本面，時間從2013 年2 月8 日 至2017 年8 月8 日，並利用基本面特徵及技術面特徵為研究變項，實驗最後顯 示使用隨機森林模型相較於其他兩個方法有顯著的超額收益。 Namdari & Li (2018) 使用多層感知器模型預測美國578 家科技公司未來股 票走勢，運用那斯達克股票交易所科技公司的財務比率和歷史股價，時間從2012 年6 月至2017 年12 月，實驗平均方向精準度可達65.87%。 Beyaz et al. (2018) 利用機器學習模型 (ANN 與SVR) 比較基本面分析與技 術面分析，預測選定公司的股價在未來 (252 和126 個交易日內) 的百分比變化， 資料庫選定為S&P500 指數中的140 家公司，公司必須具有1996 年1 月至 2015 年12 月資料，實驗結果表示同時使用技術面與基本面分析指標比單一基本面或 是技術面分析較低RMSE，在機器學習方法方面SVR 技術RMSE 比ANN 較好。 Chen & Hao (2017) 使用特徵加權支援向量機和特徵加權K-近鄰演算法的 混合框架預測中國股票股票市場指數，運用資料庫來自上海證券交易所綜合指數 和深圳證券交易所成分指數，時間自2008 年10 月31 日至2014 年12 月31 日， 研究變項包括每日開盤價，收盤價，最低價，最高價、總交易量以及技術指標， 實驗結果在短期 (1 天及5 天)、中期 (10 天及15 天) 和長期 (20 天及30 天) ， 與SVM-KNN 模型比較，均有較低的RMSE 值，故具有明顯的改進和良好的中 國股市指數預測能力。 Henrique et al. (2018) 使用支援向量回歸 (SVR) 預測股票價格，運用巴西、 美國和中國的股票，每個國家挑選3 個大型資本公司與3 個小型資本公司每日股 票資料，時間範圍2002 年5 月到2017 年5 月，實驗結果比有效市場假說提出的 隨機遊走模型有較好的預測能力。 Basak et al. (2019) 使用決策樹分類器預測美國股票市場價格上漲或是下 跌，運用AAPL、AMS、AMZN、FB、MSFT、NKE、SNE、TATA、TWTR、 TYO 等十家公司，從上市到2017 年2 月3 日的收盤價和交易量等數據，進行指 數平滑處理提取技術指標，再使用隨機森林和梯度增強決策樹預測相對於n 天前 -9- 的普遍價格是上漲還是下跌，發現對於中長期預測股票價格的方向具有很高的準 確性。 Chen & Hao (2018) 收集2012 年5 月2 日到2014 年5 月31 日上海股票市場 的二十隻股票和深圳股票市場的二十隻股票，除了使用歷史開盤價、收盤價、股 票的最高價和最低價當作變數，再添加移動平均線(MA)、指數移動平均線 (EMA)、移動平均收斂/發散(MACD)、相對強度指數(RSI)、平衡量(OBV)、動量 指數(MoM)平均交易價格(ATP)、價格變動幅度(ALT)和K 線類型(ITL)的索引作 為變數，並利用主成分分析(PCA)集成到加權支援向量機(WSVM)中，預測股票 交易點(PCA-WSVM)，實驗結果與WSVM 和PCA-ANN 相比，PCA-WSVM 在 下降趨勢、穩定趨勢和上升趨勢中對股票的預測準確性要高得多。 Barak et al. (2017) 提出融合模型，應用Bagging, Boosting 和AdaBoost 在內 的方法，建立一個多樣性分類器組合，並收集德黑蘭證券交易所(TSE) 2002 年至 2012 年400 家公司股票數據，結果表明Bagging 在融合方案中表現出優異的性 能，決策樹、LAD 樹和Rep 樹的收益預測最高可達到83.6％的準確性，BF 樹、 DTNB 和LAD 樹的風險預測可達到88.2％的最高準確性。 Fu et al. (2018) 應用機器學習演算法區分好股票與壞股票，使用中國股市 244 個技術特徵和基本特徵作為變數，並根據收益率與波動率排名進行貼標籤， 再使用邏輯式迴歸(LGR)、隨機森林(RF)、深層神經網絡(DNN)和堆疊等(RF 和 DNN 的堆疊)方法進行分類，實驗發現作者的選股策略優於市場平均水平的盈利 投資組合。 Zhang et al. (2018) 使用線性核(linear kernel)、多項式核(polynomial kernel)、 高斯核(Gaussian kernel)和Sigmoid kernel 等函數的支援向量機演算法，並利用 2005 年1 月31 日至2017 年4 月28 日的股票資料，建構上海300 及中國500 證 劵的選股策略，研究發現在定量投資領域下，不同核函數的支援向量機模型具有 強大的迴測能力。 Zhong et al. (2017) 使用收盤價、指數移動平均值、財務和經濟指標等60 個 技術指標作為變數，並分別利用主成分分析(PCA)，模糊主成分分析(FRPCA)和 -10- 內核主成分分析(KPCA)進行降維，以簡化原始數據結構，再應用人工神經網路 (ANN)預測標準普爾500 指數ETF 未來市場收益。 Patel et al. (2015) 使用印度股市的CNX Nifty、S＆P BSE Sensex、Infosys Ltd. 和Reliance Industries 2003 年至2012 年10 年的歷史股票交易數據（開盤價、最 高價、最低價和收盤價）等技術參數作為輸入變數，分別使用人工神經網絡 (ANN)、支援向量機(SVM)、隨機森林(RF)和單純貝氏分類器(NB)，預測預測股 票和股票價格指數的走勢，實驗結果發現隨機森林演算法比其他三個演算法較 優。 Kumar et al. (2018) 利用Amazon, Cipla, Eicher, Bata 和Bosch 網站五到十年 的數據，包含每日開盤價、最高價、收盤價、成交量、移動平均線等技術指標， 使用五種監督學習技術，計支援向量機(SVM)、隨機森林(RF)、K-近鄰演算法 (kNN)、單純貝氏分類器(NB)和Softmax，實驗結果表示，隨機森林演算法在大 型數據集上表現最佳，單純貝氏分類器分類器在小型數據集上表現最佳。 綜合以上相關文獻，多數研究文獻以單一面向實施研究，或單一機器學習方 法實施預測，為探討股價、基本面、技術面及籌碼面等面向於9 種機器學習模型 預測有效性，本研究以台灣股市28 種產業進行分析。。 -11- 第三章 研究方法 研究流程如圖1 所示，本研究整理從台灣證券交易所抓取的本國上市證券國 際證券辨識號碼一覽表，裡面包含了個股代號、名稱、國際證券辨識號碼 (ISIN Code) 、產業別，此資料作為本研究建立預測股價模型各產業別資料集的分類依 據，另外從台灣經濟新報抓取的調整後股價作為本研究預測股價模型訓練資料。 本研究將使用移動視窗法產生每筆資料並且使用基本面、籌碼面、技術面各項指 標作為變數，並使用Orange 資料探勘工具(https://orangedatamining.com/)裡資料 平衡方法，再訓練且建立股價預測模型；在模型建構方面，採用kNN、DT、SVM、 SGD、RF、NN、NB、LGR 及AdaBoost 等九種方法建立預測模型，再從訓練出 來的模型進行評估比較，選出最佳預測模型進行研究探討。 -12- 圖 1、研究流程 -13-
