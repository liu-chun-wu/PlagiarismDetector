依據Bot 與Botmaster 連線的方式可分為IRC（Internet Relay Channel）、HTTP （Hyper Text Transfer Protocol）、P2P（Peer to Peer）三種協定。[5] （一）IRC-based 殭屍網路 IRC 為一種協議，一種RFC 標準公開規定的，分布式的主從式架構，採用 TCP 和SSL 協議，使用者透過IRC 連上伺服器，加入頻道（Channel）便可與 別的使用者進行聊天。早期為了幫助網路管理員方便的管理系統而產生Bot 的 工具，其具有自動化，可以與其它人類使用者互動的功能，但本身其實是電腦 程式語言，在伺服器上就像一般使用者一樣出現在清單之上，駭客惡意的改寫 後轉變成為以IRC 作為C&C Server 的惡意程式。 如圖3 所示，當主機受到感染成為Bot，Bot 會嘗試連線到IRC 協定的封包 所預先定義的伺服器，並加入聊天頻道等候Botmaster 的命令；當接收到命令 時，Bot 即會對目標發動攻擊行動，再將結果回傳於頻道中。屬於此類型的殭屍 網路主要為GTbot、SDbot 以及Spybot （二）HTTP-based 殭屍網路 以HTTP 協定建構的殭屍網路，有多種感染方式，有漏洞的主機瀏覽到含 惡意的HTML 程式碼的網頁時，會連結至Botmaster 架設的伺服器將惡意程式 下載到系統中，這些行為使用者完全不知情，這種手法稱之為「強迫下載 （Drive-by-Download）」，這種類型的殭屍網路在傳送及接收命令，封包類型都 是以HTTP 為主，對使用者來說就像正常的網頁流量，因此很難去判斷及偵 測。常見的HTTP-based 殭屍網路有Zeus、BlackEnergy、Clickbot.A 等。 （三）P2P-based 殭屍網路 以P2P 協定架設的殭屍網路，與傳統主從式架構不同，沒有特定的伺服端 以及客服端，每台Client 也可以是C&C Server，Botmaster 可任意選定一台作為 Server 來控制整個殭屍網路，但通常是挑選擁有固定IP 或24 小時開機的電腦。 P2P-based 感染流程為透過一組Peer List 連線至殭屍網路，Client Bot 便可以從 Server Bot 下載特定檔案執行，取得Botmaster 的命令。此類殭屍網路有可避免 單點失效（single point failure）的特點，但相對這種架構建置也較為複雜，對於 攻擊者來說需要花較多時間佈建，較為著名的P2P-based 殭屍網路為Agobot 和 Phatbot。 圖 4  P2P-based 殭屍網路架構
