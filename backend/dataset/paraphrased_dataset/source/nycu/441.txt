本質影像(Intrinsic image)的概念由Barrow and Tenenbaum [3] 所提出，旨在從一張 輸入的影像中萃取出特徵影像，像是深度(depth)、表面反射率(surface reflectance)、表 面朝向(surface orientation)、遮擋(occlusion)等等。本質影像的模型中假設一張影像I 可 表示成實體影像(reflection/albedo) R 及光影影像(shading/illumination) S 逐點相乘。 𝐼=  𝑅∙ 𝑆 實體影像代表一個物體表面的反射率，即物體的表面顏色，對於不同的相機視角及光 照條件具有不變性；而光影影像則會隨著相機視角, 物體的幾何分布，會有不同的明 暗、陰影[11]。本質影像經常被用在許多電腦視覺、圖學、攝影學的應用上，像是重新 上色(recoloring)[4, 20]、重新打光(relighting)[21, 22]、風格化(stylization)[20]、材質編輯 (material editing)[4]等等。 大多用來解決本質影像分解的傳統方法都是基於對場景特徵、物理現象的假設， 藉由觀察物體和光線在場景中在物理上的交互作用進行發想，像是上述所提的方程 式，或是透過條件隨機場(conditional random fields, CRFs) [1]的方法。其中，最廣為人 知的就是Retinex 圖像增強演算法[13]，Retinex 演算法中假設實體影像具有大範圍的一 致性，所以較大的梯度(gradient)通常對應到實體影像；而較小的梯度則通常對應到較 平滑的光影變化。因此，對於較銳利的光影變化或是材質的多樣性較高，就成了一個 很大的限制。 近年來，許多深度學習架構的方法[5, 6, 7, 8, 11, 12]被提出來解決本質影像分解的 問題，比較先前的研究多是提倡僅透過深度學習就能產生還不錯的結果，到最近幾年 的研究則是發現透過深度學習的架構與物理性質假設的結合能夠產生更好的結果，[11] 加入了物理性質條件，[8]結合了條件隨機場(CRFs)的概念，[5]則提出用對抗概念的網 路架構，與我們研究最相關的就是Janner et al.[7]。 我們的目標是要學習室內場景的光源配置，Janner et al.[7]則是學習單一物件的顏 色、形狀和光影條件。從下圖中，我們可以思考一下對於圖6a 的陶瓷花瓶而言，依照 我們對真實世界的認知，可以很直覺地將顏色、形狀、光影條件分解成如圖6b 的形 式，但如圖6c 分解成平坦形狀或像圖6d 分解出奇怪的顏色和光影卻也能重組成原始 影像，這就是在本質影像分解上因缺乏限制而造成的困難之處。因此我們要的結果不 只是一個有效的答案，還要是一個實際上最有可能的結果。 圖 6 說明從一張影像進行本質分解可能得到的分解方式有很多種 於是，[7]提出了一個自動編碼器(autoencoder)的架構，包含了一個共享convolution 的編碼器(encoder)及三個分支的解碼器(decoder)，三個分支分別是顏色、形狀和光源條 件。形狀和光源條件會用來訓練一個可微分的光影函數(shading function)，即是將光影 的效果套用到形狀上，再由此輸出和顏色結合成原本的輸入。這樣的架構不僅能藉由 輸入一張影像的得到本質的分解，也能重建出影像，因此可以透過沒有本質分解參考 標準的影像來加強中間部分本質分解的表現。 圖 7 Janner et al.[7]用來進行本質影像分解的自動編碼器架構，藉由分解出顏色、形狀和光源條件，再 由形狀和光源條件組合出光影函數，進而與顏色進行相乘後能夠得到原始圖像。 圖8 是由此架構訓練出的結果。利用ShapeNet 的飛機類別進行訓練並在汽車類別 上進行預測。Direct transfer 是用影像輸入並進行本質分解，因此僅能使用具有參考標 準的資料，由於飛機類別的顏色大多偏向白色，即便是色彩繽紛的汽車在顏色上也變 得很淡。Self-supervised 即是加入了後方重建影像的架構，從結果中我們可以發現加入 了這樣的架構能有效增強在顏色上的辨識程度，顯然這樣的架構是有效的。 圖 8 比較有無加入self-supervised 的概念訓練出的結果
