食物與目標輪廓的比對會根據食物的型態(是否可塑形)及大小，採用不同演算法進行比對， 產生的結果我們會存成自訂的資料型態𝑅𝑆𝑓𝐼𝑑𝑥 𝑐𝐼𝑑𝑥，儲存對應的目標輪廓編號cIdx、食物編號fIdx、 採用哪一種比對方式、比對後的擺盤結果的影像與輪廓點群𝐶𝑜𝑛𝑡𝑜𝑢𝑟𝑟、以及擺盤結果與目標輪 廓的各項差異值𝐸𝑐𝑜𝑙𝑜𝑟、𝐸𝑖𝑐𝑝、𝐸𝑎𝑟𝑒𝑎，此三項差異值是用來評估擺盤結果與目標輪廓的相似性。 𝐸𝑐𝑜𝑙𝑜𝑟為擺盤結果與目標輪廓的顏色差異值，擺盤結果的顏色為𝐶𝑜𝑙𝑜𝑟𝑓為食物圖案的平均顏 色值，而目標輪廓的顏色值𝐶𝑜𝑙𝑜𝑟𝑡可由最初的目標圖案中取得。計算顏色差異的過程會先將RGB 空間的色彩轉換到較為均勻的CIE Lab 空間，此外，因為在Opencv 的Lab 色彩空間中，此三通 道的範圍分別為0~255、 0~255、 0~255，為了normalize 此兩顏色誤差的值在0 到1 之間，各 通道相減後的值都要再除以255，計算𝐸𝑐𝑜𝑙𝑜𝑟的公式如下： 𝐸𝑐𝑜𝑙𝑜𝑟 = √|𝐶𝑜𝑙𝑜𝑟𝐿 𝑡−𝐶𝑜𝑙𝑜𝑟𝐿 𝑓| +|𝐶𝑜𝑙𝑜𝑟𝑎 𝑡−𝐶𝑜𝑙𝑜𝑟𝑎 𝑓| +|𝐶𝑜𝑙𝑜𝑟𝑏 𝑡−𝐶𝑜𝑙𝑜𝑟𝑏 𝑓| 𝐸𝑖𝑐𝑝用來評估擺盤結果與目標輪廓的形狀差異度，計算方法為，對於目標輪廓的所有點q∈𝐶𝑞 都找到一個擺盤結果輪廓的最近點r∈𝐶𝑟，共可以得到𝐴𝑞組的對應點，接著計算這些對應點的距 離變異數值，即為所求，同樣的為了normalize，會再除以總對應點數量。 icpAveDist = ∑ 𝑚𝑖𝑛𝐷𝑖𝑠𝑡(𝐶𝑞𝑖,𝐶𝑟) 𝐴𝑞 𝑖=0 𝐴𝑞 𝐸𝑖𝑐𝑝= ∑ (𝑖𝑐𝑝𝐴𝑣𝑒𝐷𝑖𝑠𝑡 − 𝑚𝑖𝑛𝐷𝑖𝑠𝑡(𝐶𝑞𝑖,𝐶𝑟)) 𝐴𝑞 𝑖=0 𝐴𝑞 𝐸𝑎𝑟𝑒𝑎則為擺盤結果與目標輪廓的面積未被滿足的部分。在擺盤過程中，我們需要食物盡量 的填滿目標輪廓面積，同時擺盤結果的面積也都要盡量被滿足，不要超出目標輪廓的範圍太多， 也就是說，擺盤結果與目標輪廓兩者未被滿足的面積要越小越好，而為了normalize 此項值在0 到1 之間，未被滿足的面積需再除以目標輪廓的面積。此外，由於各項Error 值最後需統一加總， 用來判斷擺盤結果與目標輪廓的整體相似度，為了統一各項單位，我們對目前𝐸𝑎𝑟𝑒𝑎計算出的面 積值進行開根號，將其從二維降至一維資訊。假設目標輪廓面積𝜋𝑞與擺盤結果面積𝜋𝑟的交集面 積為𝜋𝑞∩𝑟、聯集面積為𝜋𝑞∪𝑟，計算𝐸𝑎𝑟𝑒𝑎的公式可以寫成： 𝐸𝑎𝑟𝑒𝑎= √ 𝜋𝑞∪𝑟−𝜋𝑞∩𝑟 𝜋𝑞 最後，將此三項Error 值相加，分別賦予不同權重系數，可得到Error𝑡𝑜𝑡𝑎𝑙用來評估擺盤結 果的好壞，Error 值越小，代表擺盤結果與目標圖案的差異越小，相似度越高。 Error𝑡𝑜𝑡𝑎𝑙 = w𝑐*Error𝑐𝑜𝑙𝑜𝑟 + w𝑖*Error𝑖𝑐𝑝 + w𝑎*Error𝑎𝑟𝑒𝑎
