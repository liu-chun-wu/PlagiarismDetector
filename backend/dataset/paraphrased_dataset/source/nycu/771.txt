這一節我們將利用實際拍攝的空拍影像資料集對YOLOv3 進行微調訓練(Fine- tuning)，3.1.1 節會介紹所使用的空拍影像資料集，而3.1.2 節則說明微調訓練的方法。 3.1.1 空拍影像資料集 本研究期望微調訓練後的YOLOv3，能更適合偵測空拍影像中的「人」， 因此需要 先蒐集相對應的訓練資料。根據YOLO 作者Redmon 建議，訓練YOLO 模型每一類別 不同俯仰角度、高度、場景的空拍影像，並加以標計人物的正確位置(Bounding Box Ground Truth)，總共1340 張，以建立空拍影像資料集。其中，我們隨機選取1250 張影 像當作訓練資料集(Training Set)，並以剩餘90 張影像當作驗證資料集(Validation Set)， 圖3-1 為我們所建立的空拍影像資料集範例。 圖3-1 空拍影像資料集範例 3.1.2 使用空拍影像對YOLOv3 進行微調訓練(Fine-tuning) 空拍影像的人物偵測與一般影像人物偵測是兩個非常類似的問題，因此在蒐集完空 拍影像資料集後，可以透過微調訓練的方式使YOLOv3 適合空拍影像人物偵測而不必 從零開始訓練。 YOLOv3 的架構分為特徵提取器Darknet-53 及偵測層，原模型訓練方法為先對Dark- net-53 在ImageNet 資料庫上進行預先訓練(Pretrain)，再將整個YOLOv3 使用COCO 資 料庫進行正式訓練。預先訓練可使Darknet-53 提取更具代表性的特徵，進而提升正式訓 練的收斂速度。本文所蒐集的空拍影像人物偵測資料集比COCO 資料庫小很多，因此我 們由原YOLOv3 的參數繼續訓練，並凍結Darknet-53 的參數(Freeze Weights)，只更新偵 測層的參數，採用如圖3-2 的微調訓練方法使YOLOv3 適應空拍影像人物偵測。 圖3-2 對YOLOv3 微調訓練的方法示意圖 訓練過程中同樣也對訓練影像進行資料擴增(Data Augmentation)處理，包含翻轉、 旋轉、調整曝光度等等，藉此解決資料不足的困境，並提升系統訓練的準確度，資料擴 Freeze weights Train these 增範例如圖3-3 所示。訓練時的參數測定，批次大小(Batch Size)為64，學習率(Learning Rate)降低一半為0.0005，總共訓練10,000 次迴圈(Iteration)，原因是我們期望1250 張訓 練影像能經過資料擴增而有五倍影像量的效果，並且希望看過整個資料集100 遍(100 epoch)，由此可得 1250∗5 ∗100 ≒10,000次迴圈。經微調訓練後的偵測結果如圖3-4 所示， 先前無法偵測到的行人現在也可偵測成功了。 圖3-3 資料擴增範例 圖3-4 微調訓練後的YOLOv3 偵測結果
