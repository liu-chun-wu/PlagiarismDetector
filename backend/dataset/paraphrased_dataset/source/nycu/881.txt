Further, to speed up the computation and reduce the amounts of data of equation (5), we use singular value decomposition (SVD) to reduce the dimension of the matrix 𝐓′. After SVD calculation, 𝐓′ can be rewritten as 𝐓′ = 𝐔𝚺𝐕𝑇,                        (6) where 𝐔∈ℝ𝑚×𝑚, and 𝐕∈ℝ𝑛×𝑛 are orthogonal matrices, that is 𝐔𝑇= 𝐔−1,and 𝐕𝑇= 𝐕−1. 𝚺∈ℝ𝑚×𝑛  is a diagonal matrix of same dimension of 𝐓′ . We reduce the dimension by discarding the singular values in 𝚺, and keep a percentage of energy 𝛼 as defined below, ∑ 𝚺𝑖𝑖 𝑘 𝑖=1 ∑ 𝚺𝑖𝑖 𝑛 𝑖=1 ≥ 𝛼,                            (7) Here we select 𝛼= 90%. By selecting the top 𝑘 values in, we can reduce the dimension of 𝚺 to 𝑘× 𝑘, and also reduce 𝐔 to 𝑚× 𝑘 and 𝐕𝑇 to 𝑘× 𝑛. We redefined 𝐓′ as 𝐓′ = 𝐀𝐙,                               (8) where 𝐀  is 𝐔  with dimensionality reduction, and 𝐙  is the product of a diagonal matrix composed by top 𝑘 elements of 𝚺 and 𝐕𝑇 with dimensionality reduction, both shown below, 𝐀= [𝐔1, 𝐔2, ⋯, 𝐔𝑘],                         (9) 𝐙= diag([𝐔1, 𝐔2, ⋯, 𝐔𝑘])[𝐕1, 𝐕2, ⋯, 𝐕𝑘]𝑇.            (10) By equations (5) and (8), we can get 𝐒= 𝐀𝐙𝑝′.                             (11) We reconstruct the templates as the matrix 𝐓′ and do the SVD on it on PC offline. The matrix is saved as an yml file for reading on the mobile device. To speed up the computation, the matrix multiplication of score vector 𝐒 is executing in parallel for each row using OpenMP.
