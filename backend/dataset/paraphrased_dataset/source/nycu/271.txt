在瞭解Botnet 中的運作模式後，可知Bot 與C&C Server 溝通多是使用Domain name 的方式，有些國外防火牆大廠，如Fortinet 就在防火牆中加入DNS-Filter 功能用 以阻檔Bot 與C&C Server 間的資料傳輸。 具體流程如圖8 所示，當使用者發出一個DNS request 時，封包通過啟用dns- filter 的設備，設備會將FQDN 或IP 與資料庫中的資料比對，若目的端是屬於高資安 風險的目標則會將此請求丟棄或是導向一個警告的網頁，當使用者中殭屍病毒時利用 具有此功能的設備可以有效阻截異常流量防止佔用對外頻寬，避免淪為駭客手中發動 DDOS 的工具，或是當使用者將前往釣魚網站、惡意網站這類高風險，易被植入木馬 的網站也同樣會生效，大大降低感染風險。 圖 8 Fortinet DNS-Filter 功能 但此功能並非可以檢測所有的Botnet 流量，還是取決於服務提供商的資料庫有多 少Botnet 的IP 位址以及更新的頻率，且當駭客註冊新的網域的空窗期、Bot 並非使用 網域名稱與C&C Server 溝通、抑或是使用P2P 架構的Botnet 就無法透過DNS Filter 做 防護。 市面上具有此功能的設備價格都偏高，對於個體用戶是筆不小的負擔，故另一個 方法就是將DNS 指向具有DNS Filter 功能的server，坊間有許多公司提供此服務，較 著名的有Norton ConnectSafe 以及OPENDNS…等，兩種方法整體作用相同，但仍有其 差異，即是後者的DNS 封包仍會發出，當Requests 爆量時，仍可能造成頻寬的佔用。 OPENDNS 以及Norton ConnectSafe 皆為免費服務，Norton ConnectSafe 提供了三 種預先定義的過濾內容，參考表1 所示。 政策 DNS IP 說明 安全性  199.85.126.10  199.85.127.10 攔截裝載惡意軟體的所有網站、釣魚網 站和詐欺網站 安全性 + 色情  199.85.126.20  199.85.127.20 除了攔截不安全的網站，此政策還會攔 截存取包含性暴露材料的網站。 安全性 + 色情 + 其 他  199.85.126.30  199.85.127.30 除了攔截不安全的網站和色情網站，此 政策還會攔截存取提供成人內容、墮 胎、酒精、罪犯、迷信、毒品、賭博、 憎恨、性向、自殺、煙品或暴力等的網 站。 表 1 Norton ConnectSafe Filter Policy DNS 服務對於速度的要求是非常高的，當延遲過高時，會造成解析過慢，使 用者會非常有感，而這兩者在實測後，皆在延遲30ms 上下，屬於可以接受的範圍。另 外較多人使用的google DNS（8.8.8.8）延遲約在10ms 以下，Hinet（168.95.1.1）則在 5ms 以下。
