Wang et al.[2]以ResNet50 架構為基礎建構模型，使用在ImageNet 上已訓練好的權 重做為初始權重值，並將架構中最後的全連接層及輸出分類層去除，並加入一個轉移層 (Transition Layer)、一個全局池化層(Global Pooling Layer)、輸出預測層(Prediction Layer) 以及計算損失函數的損失層(Loss Layer)。 轉移層的作用在於將前一層激勵函數的輸出轉換為適合的輸出維度，轉移層有助於 從標準形式的預訓練CNN 模型中傳遞權重。在損失函數的部分，由於此研究為多標籤 分類問題，在單一影像中，無異常的種類數會比有異常的種類數來的多，因此在標籤陣 列部分，0 會比1 來的多，神經網路較難學習到含有異常的例子，為了解決這個問題， Wang et al.在加權交叉熵損失(Weighted Cross Entropy Loss, W-CEL)函數中導入了正、負 平衡因子 P 、 N 來增強學習。導入了 P 、 N 的W-CEL 函數公式如下。                CEL - W ) ( ln ) ( ln ) ), ( ( L c c y c N y c P x f x f y x f   其中， P N P P    、 N N P N    ，P 為這一批影像中，影像標籤中0 的總數、N 為這一批影像中，影像標籤中1 的總數。 此研究結果平均ACU ROC 為0.738，各項異常的ACU ROC 分別為：肺不張為 0.716、心臟肥大為0.807、肺積液為0.784、肺浸潤為0.609、腫塊為0.706、結節為0.671、 肺炎為0.633、氣胸為0.806、肺實變為0.708、肺水腫為0.835、肺氣腫為0.815、纖維 化為0.769、胸膜增厚為0.708、疝氣為0.767。其中肺水腫結果最好、肺浸潤(Infiltration) 結果最差。詳細結果請見表三。
