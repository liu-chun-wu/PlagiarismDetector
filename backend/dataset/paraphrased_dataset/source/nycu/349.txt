Siamese Network 為孿生網路架構，是一種metric learning 的方法。意即 入一對圖片樣本，經過相同參數的主幹（backbone）網路後，映射到新的空間 中，各自得到一組特徵向量。而這一對圖片的相似度即由這一組特徵向量的歐 式距離（Euclidean distance）來判別。此架構適合用於當類別數量多，但每一類 別的樣本數不多的情況。行人重識別任務也常使用Siamese 架構網路，並且除 了metric learning 外，加上身份分類的ID loss 能進一步強化辨別人物的能力 圖3-2 MOTChallenge 部分場景及偵測器範例 [28]。然而本文主旨為提出非監督式學習方法，無法取得人物的ID，因此僅使 用metric learning。 本文使用的Siamese 架構如圖3-3，主幹網路採用ResNet-50[30]，其深層 的CNN 網路對於特徵擷取有很強的能力。我們使用預訓練（pretrained）於 ImageNet 的ResNet-50 網路，其權重已有一定的特徵擷取能力，並使用遷移式 學習（transfer learning），移除其最上層之分類層，僅留下主幹網路，尾端接上 L2 Normalization 層限縮空間大小，再加上一層Global Average Pooling 2D 降低 特徵維度。以此特徵作為metric learning 的依據進行拉近正樣本、拉遠負樣本的 任務。訓練時輸入依照損失函數，若為contrastive loss，則輸入兩張圖片。若為 triplet loss，則會有第三個輸入（圖3-3 中的Input 3）。當訓練完成後，移除 Loss 層即可將此網路作為行人特徵擷取器。每一個行人的圖片經由此網路，可 得到一長度為2048 的特徵向量。
