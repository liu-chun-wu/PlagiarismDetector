我們在此章節一樣使用FFT 後的影像做檢測，與3.2 小節不同的地方在於這個演 算法是3.2 小節需要取Threshold 做二值化，而此章節是直接拿影像原圖以及視覺化後 影像做檢測。做完視覺化後的方格會經過以下流程做判斷處理：(1)製作Mask，並畫出 統計圖表 (2)計算peak 之間關係 (3)框出有線性瑕疵絲餅方格。其流程如圖3-13 所示。 黃 綠 淺藍 深紅 紅 橙 紫 深藍 圖  3-13 利用FFT 後視覺化之影像檢測流程圖 3.3.1 製作Mask 此小節利用做完FFT 後視覺化影像，用一個mask 將影像上的白點作統計，與3.2.2 章節一樣，由於影像轉至傅立葉後會對稱，所以我們只需要看一半的影像便可知道另一 半的樣子。我們首先將中心 𝑀× 𝑀 的點變成黑色，再來從影像左上角連線至中心點， 拉出一條寬度為1 pixel 的直線，接著逆時針每隔4 pixels 直到拉至右下角，畫出一mask， 以便計算影像上的白點。由於方格原圖上下與左右的不銜接，造成FFT 後水平與垂直的 部分在高頻仍有能量，如圖3-14 所示，其上下左右都無法銜接，所以在水平與垂直高 頻的部分有能量，為了方便觀察我們把FFT 後的影像做負片，箭頭指向為有高頻能量結 果。 在此小節我們以直線從中心出發到邊線的百分比當變數，將單條線從中心點出發到 某百分比的能量點加總起來。若百分比為20%，表示我們只將中心點出發到線20%的能 量點加總，如圖3-15 所示，我們藉由調整不同百分比，觀察其造成的結果。 圖  3-14 由於影像不銜接，造成水平垂直在高頻部分有能量 (a) 原圖 (b) FFT 視覺化影像 3.3.2 計算Peak 之間關係 同章節4.2.4，我們除了考慮最大peak 位置、第二大peak 位置以及兩者距離外， 還多考慮了peaks 之間的group 關係。若第一大peak 與第二大peak 在之間的波谷在規 定的百分比之上，則將第一與第二個peak 視為同一個group，並比較第一大peak 與第 三大peak 之距離，如果距離大於5，則視為瑕疵，如圖3-16 所示，黃色虛線為大於最 大peak 60% 的臨界線，可以看出有三個peak 大於門檻值，且第一與第二大peak 的波 谷在門檻值之上，因此我們判斷第三大peak 與第一大peak 的距離，此距離大於10，所 以該方格被判斷成有瑕疵。 圖  3-16  peak 在正確位置，第一與第二大peak 屬同group， 而第一與大三大peak 距離過大，因此歸類成瑕 疵 圖  3-15 利用不同能量遮罩範圍來去除高頻雜訊 3.3.3 框出有線性瑕疵之方格 與章節3.2.5 相同，將統計圖區分成八個顏色，若最大值在異常位置時，我們會將 方格以最大值peak 所在區間之顏色框出來；若最大值在正確位置，但第二或第三peak 與最大peak 相差距離大於門檻的話，我們會將左上角以最大值peak 所在區間之顏色框 出來，右下角以第二或第三大peak 所在區間之顏色框出來。以圖3-17 為例，第一大peak 在正確位置，所以將第一大peak 位置顏色(綠色)標記在左上角，而第二大peak 與第一 大peak 在同一個group，於是觀察第三大peak，其與第一大peak 距離相差夠大，其位 置在黃色區間，所以將右下角以黃色標記。 圖  3-17 最大值與第二或第三大peak 所在位置之對應外框顏色 3.4 不同方法之整理 我們利用表3-1，來做不同方法在前處理與偵測在不同域上的整理，以便比較觀察。 淺藍 紫 橙 紅 深紅 深藍 綠 黃 表 3-1 不同方法之整理 第4章 實驗環境與實驗結果
