由於VISA、Master Card等組織不允許其他公司使用其信用卡詐欺偵測架構，因此需自行開發。雖然如此，信用卡組織會提供詐欺交易歷史資料給EMVCo認可的實驗室，K-Star系統將利用這些資料建立訓練資料庫。為提高預測準確性，本研究採用雙階段判定方法（圖19），例外狀況則需人工處理。

首先，基於K. R. Seeja和Masoumeh Zareapoor (2014) 以及Agrawal和Srikant (1994)提出的KNN搭配Apriori資料庫訓練演算法，使用客戶的五個特徵值，對Visa原始資料和ABT資料庫D進行訓練：

1. 從資料庫D中分離每位客戶的交易資料。
2. 將每位客戶的交易資料區分為詐欺和非詐欺資料。
3. 對每位客戶的非詐欺資料集應用Apriori演算法，提取出現頻率最高的特徵資料，並將其存入非詐欺資料庫（圖20標示1、2）。
4. 對每位客戶的詐欺資料集應用Apriori演算法，提取出現頻率最高的特徵資料，並將其存入詐欺資料庫（圖20標示1、2）。

完成資料庫D的訓練後，接下來說明圖24 "K-Star Predictive Model" 中的詐欺偵測演算法，該演算法基於K. R. Seeja和Masoumeh Zareapoor (2014) 的研究：

1. 統計新交易特徵在非詐欺資料集中相符的個數 (lc)。
2. 統計新交易特徵在詐欺資料集中相符的個數 (fc)。
3. 若fc = 0且lc大於所有客戶lc的平均值，則判定為非詐欺交易，輸出0。
4. 若lc = 0且fc大於所有客戶fc的平均值，則判定為詐欺交易，輸出1。
5. 若fc和lc都大於0且fc ≥ lc，則判定為詐欺交易，輸出1；否則為非詐欺交易，輸出0。

經過上述步驟後，判定結果將送回ABT訓練資料庫，進行下一階段的Random Forest演算法計算（圖20）。

接下來，使用Random Forest說明K-Star如何利用五個特徵值和加權係數，透過多數決定預測是否詐欺（圖22）。步驟如下：

1. 定義大小為m的隨機樣本，從資料集中隨機選取m筆資料（取後放回）。
2. 使用選取的m筆資料訓練決策樹。對於每個節點：
    a. 隨機選取N個特徵。
    b. 使用特徵分割該節點。
3. 重複步驟1和2 m次。
4. 彙整所有決策樹的預測，以多數平均方式決定最終預測結果。


使用表9的ABT交易資料作為範例，根據Random Forest演算法進行實驗：

1. 比對年齡是否大於50歲。
2. 比對郵遞區號是否位於定義的高犯罪率區域前兩名。
3. 比對交易金額是否超過8k。
4. 比對是否為高犯罪機率職業前五名。
5. 比對24小時內發送的10條確認簡訊是否有回應。

我們定義取3棵樹的平均預測值（圖23）。每次隨機從5個特徵值中選取，根據Random Forest的平均預測結果，範例資料被判定為詐欺交易，並將其放回ABT訓練資料庫。系統可根據設計重新取樣計算，以提高準確性。FP-ABT即透過上述模組進行詐欺偵測。

為了優化K-Star演算法並訓練更好的預測模型，我們使用LightGBM演算法。LightGBM是由微軟DMTK團隊於2016年開發，效率更高、準確率更高且記憶體使用更低。由於Visa提供的訓練資料量龐大，LightGBM的直方圖演算法可以加快訓練速度並減少記憶體使用。

K-Star訓練資料庫搭配Random Forest決策森林，可在K-Star詐欺偵測流程（圖26 "K-Star Predictive model"）中進行詐欺交易偵測。當旅客使用NFC裝置完成購票並準備開始旅程時（圖25 "Welcome the transaction"），系統會向ABT伺服器查詢客戶資料（"Request Customer’s data"），獲取客戶資料後（"Get customer’s profile"），進入K-Star Predictive model進行偵測。系統將使用者的五個特徵值送至K-Star Predictive model進行查詢。若預測模型將交易標記為可能欺詐，系統會立即拒絕交易，並透過ABT Back Office或ABT APP通知使用者。

除了詐欺偵測外，FP-ABT的另一個特色功能是基於K-Anonymity理論的隱私保護，整體系統架構如圖27所示。
