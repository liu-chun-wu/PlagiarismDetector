多屬性分類器的成本函數並非單一屬性分類器成本函數的簡單加總。本研究計算多屬性分類器成本函數的方法如下：先分別計算所有衣服屬性分支的全連接層的成本函數，再依各自比重加總。每個衣服屬性分支的全連接層成本函數計算方式如下：

首先，引入成本函數  F = ∑ (λₖ * Gₖ)  (k=1 to K)，其中 Gₖ 為每個衣服屬性的成本，K 為衣服屬性類別總數，λₖ 為每個衣服屬性的成本比重，在本研究中設定 λₖ = K。

Gₖ 的初始定義為： Gₖ = - (1/N) * ∑(n=1 to N)∑(m=1 to Mₖ) [1{yₙᵏ=m} * log(e^((wₘᵏ)ᵀ•xₙᵏ) / ∑(k=1 to Mₖ) e^((wₘᵏ)ᵀ•xₙᵏ))]，其中 {xₙᵏ, yₙᵏ} 代表一個訓練資料集，yₙᵏ 是第 n 個樣本 xₙᵏ 的第 k 個衣服屬性，N 代表訓練資料集的資料總數，Mₖ 代表第 k 個衣服屬性的類別個數，1{∙} 為指示函數。

由於資料集存在嚴重不平衡問題（詳見表 3-1、表 3-2、表 3-3），為避免訓練結果偏向數量較多的類別，將 Gₖ 修正為： Gₖ = - (1/N) * ∑(n=1 to N)∑(m=1 to Mₖ) [1{yₙᵏ=m} * βₘᵏ * log(e^((wₘᵏ)ᵀ•xₙᵏ) / ∑(k=1 to Mₖ) e^((wₘᵏ)ᵀ•xₙᵏ))]，其中 βₘᵏ = N / (Mₖ * Nₘᵏ)，Nₘᵏ 為第 k 個衣服屬性的第 m 類之數量，且滿足 ∑(m=1 to Mₖ) Nₘᵏ = N。

為控制 Nₘᵏ 的最小值，引入變數 N*，使 Nₘᵏ = max(N*, Nₘᵏ)。N* 越接近 Batch Size / Mₖ，各類別的 βₘᵏ 越接近，對 Loss 值的影響越小；N* 越小，βₘᵏ 對 Loss 值的影響越大。

本研究採用此成本函數以降低資料不平衡的影響，避免多屬性分類器預測結果偏向數量較多類別，並利用此函數計算結果影響反向傳播中的權重調整。
