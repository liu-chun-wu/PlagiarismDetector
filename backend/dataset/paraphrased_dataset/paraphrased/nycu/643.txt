顧客進入商店前需刷卡通過閘門。產學合作架設的MQTT系統會在刷卡時發送訊號，指示人員進出。收到進入訊號後，系統開始追蹤該顧客，初始位置設定在顧客進入閘門的瞬間（圖3-11）。顧客離開商店同樣需刷卡通過閘門，完全離開後系統停止追蹤。

開始追蹤後，樹莓派會將偵測到的實際座標傳送至PC。PC根據距離該顧客ID前一刻位置最近的原則分配這些座標。每個ID獲得的每個點權重相同，計算方式為：將各點相對於ID位置的位移加總平均後，再與前一刻位置相加，得到ID的當前位置。圖3-12展示了對圖3-10進行追蹤的結果。圖3-13則顯示了圖3-12中紫色人物周圍樹莓派的偵測結果。

圖3-10和圖3-12是在PC上模擬實際情況，使用預先錄製的影片。由於樹莓派數量眾多，錄製時不同步，因此每個樹莓派在錄製同時需記錄每個影格的時間。錄製結束後會生成時間戳，供日後模擬時同步影片。例如，圖3-14顯示在影格132開始追蹤某ID；圖3-15顯示在影格1750和1751結束追蹤某ID。由於是模擬，追蹤的起始和結束判定與實際情況不同。

本論文使用的電腦硬體為：Intel(R) Core(TM)i5-4440 CPU，作業系統為64位元Windows 7。程式語言為Python，輔助開發工具為OpenCV 3.4.0，環境為Spyder；樹莓派作業系統為Debian，程式語言為Python，使用OpenCV 3.4.0進行預估。

測試資料來自工研院的無人商店。樹莓派魚眼鏡頭影像大小為640x480，擷取中間320x320區域，縮小至160x160，fps設定為10。測試影像中的人物會進出商店，場景內人數限制在5人以內。人物追蹤以閘門出入為基準點。人物通過閘門進入商店後，樹莓派會將預估位置傳送至電腦進行追蹤。人物離開閘門後，系統停止追蹤。

由於工研院無人商店尚未正式營運，本論文所有影像和影片均為自行錄製，人物行為皆為模擬消費者在商店中的行為。評估指標為MOTA和IDF1。
