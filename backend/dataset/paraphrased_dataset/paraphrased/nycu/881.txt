為了加速計算並減少公式(5)的數據量，我們使用奇異值分解(SVD)來降低矩陣𝐓′的維度。SVD計算後，𝐓′可以改寫為 𝐓′ = 𝐔𝚺𝐕ᵀ，其中𝐔∈ℝᵐ×ᵐ和𝐕∈ℝⁿ×ⁿ是正交矩陣，即𝐔ᵀ= 𝐔⁻¹，且𝐕ᵀ= 𝐕⁻¹。𝚺∈ℝᵐ×ⁿ是與𝐓′相同維度的對角矩陣。我們透過捨棄𝚺中的奇異值來降低維度，並保留一定比例的能量𝛼，定義如下：∑(i=1,k) 𝚺ᵢᵢ / ∑(i=1,n) 𝚺ᵢᵢ ≥ 𝛼。這裡我們選擇𝛼= 90%。透過選擇𝚺中前𝑘個值，我們可以將𝚺的維度降低到𝑘×𝑘，同時將𝐔降低到𝑚×𝑘，𝐕ᵀ降低到𝑘×𝑛。我們將𝐓′重新定義為 𝐓′ = 𝐀𝐙，其中𝐀是降維後的𝐔，𝐙是𝚺的前𝑘個元素組成的對角矩陣與降維後的𝐕ᵀ的乘積，如下所示：𝐀= [𝐔₁, 𝐔₂, ⋯, 𝐔ₖ]， 𝐙= diag([𝚺₁, 𝚺₂, ⋯, 𝚺ₖ])[𝐕₁, 𝐕₂, ⋯, 𝐕ₖ]ᵀ。根據公式(5)和(8)，我們可以得到𝐒= 𝐀𝐙𝑝′。我們在PC上離線重建模板為矩陣𝐓′並對其進行SVD。該矩陣保存為yml文件以便在移動設備上讀取。為了加速計算，得分向量𝐒的矩陣乘法使用OpenMP對每一行進行並行執行。
