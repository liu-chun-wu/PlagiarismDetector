此系統旨在建立一個股價與基本面資料處理及績效回測系統。系統流程分為四個子系統：

**1. 股價與基本面資料處理子系統：**

此子系統處理 Compustat 資料庫中 1998 年至 2016 年的財務資料，並從 Yahoo! Finance 獲取股價數據，計算 30 個基本面因子。參考謝昀峻（2018）的研究，將因子值排名並 10 等分切割，結果儲存至資料庫以供後續使用。


**2. 投資組合及策略績效回測子系統：**

此子系統使用 Amibroker 和 Python 進行策略參數最佳化和投資組合績效回測。主要變數包含：技術面策略（買入持有、凱特通道）、參數設定（固定參數、個股最佳化）、資金配置法（平均投入資金法、平均 ATR 風險投入法、平均標準差風險投入法）、資金再投入法（不投入、年複利再投入）、30 個基本面因子及其 10 等分排名，以及最大持有股數（10、20、60、120、180）。

為實現自動化和擴充性，系統採用物件導向的投資組合模型，包含三個類別：MultiPortfolio、AnalyzableMP 和 AnalyzablePortfolio。 MultiPortfolio 儲存所有變數列表，AnalyzableMP 和 AnalyzablePortfolio 則根據變數列表產生單一投資組合並計算績效。

系統自動化了 Amibroker 回測流程。Python 程式呼叫 Amibroker 執行單一策略參數最佳化，並將結果彙整成報表。回測技術面策略時，Python 程式根據投資組合模型生成多個可執行技術策略回測 apx 檔案，呼叫 Amibroker 執行回測，並將交易紀錄匯出成 csv 檔案。最後，Python 程式根據投資組合變數和交易紀錄計算實際投入金額和購買股數，生成投資組合交易紀錄並儲存至資料庫。


**3. 投資組合績效分析子系統：**

此子系統分析回測結果，包含敘述性統計分析、迴歸分析（探討因子排名與獲利的關係）、獲利來源分析（評估投資組合的穩定性）和關鍵績效指標分析（淨利、最大交易虧損、夏普比率）。系統將績效指標正規化成 1 至 10 的分數，方便比較。


**4. 視覺化呈現子系統：**

此子系統使用 Jupyter Notebook 將績效分析結果以視覺化圖表呈現，包含迴歸分析比較圖、獲利來源分析圖和關鍵績效指標分析比較圖，方便使用者理解分析結果。
